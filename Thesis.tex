% Packages and bibliography
\documentclass[english,a4paper,12pt,oneside]{scrbook}
\usepackage[utf8]{inputenc}
\usepackage{amsmath, amsthm, amssymb}
\usepackage[english]{babel}
\usepackage{marvosym}
\usepackage{graphics}
\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{float}
\usepackage{mathtools}
\usepackage{calrsfs}
\DeclareMathAlphabet{\pazocal}{OMS}{zplm}{m}{n}
\usepackage[toc,page]{appendix}
\usepackage{xcolor}
\usepackage{cleveref}
\usepackage[backend=bibtex]{biblatex}
\usepackage[nottoc,notlot,notlof]{tocbibind}
\usepackage{tikz-cd}
\addbibresource{Bibliography/bibliography.bib}

% Formatting options
\setlength{\parindent}{0em}
\parskip = 0.35cm \relax
%\renewcommand{\baselinestretch}{1.25}

% Equations and theorems style
\counterwithin*{equation}{section}
\counterwithin*{equation}{subsection}
\renewcommand{\theequation}{%
  \thesection.%
  \ifnum\value{subsection}>0 \arabic{subsection}.\fi
  \arabic{equation}%
}
\newtheoremstyle{break}
  {\topsep}{\topsep}%
  {\upshape}{}%
  {\bfseries}{}%
  {\newline}{}%
\theoremstyle{break}
\newtheorem{thm}[equation]{Theorem}
\newtheorem{cor}[equation]{Corollary}
\newtheorem{lemma}[equation]{Lemma}
\newtheorem{defn}[equation]{Definition}
\newtheorem{prop}[equation]{Proposition}
\newtheorem{ass}[equation]{Assumption}
\newtheorem{pb}[equation]{Problem}
\newenvironment{mproof}[1][\proofname]{%
  \begin{proof}[#1]$ $\par\nobreak\ignorespaces
}{%
  \end{proof}
}
\renewcommand*{\proofname}{Proof}
\theoremstyle{remark}
\newtheorem{obs}[equation]{Observation}
\newtheorem{es}[equation]{Example}

% Useful commands
\newcommand{\mR}{\mathbb{R}}
\newcommand{\cV}{\pazocal{V}}
\newcommand{\ds}{\displaystyle}
\newcommand{\norm}[1]{\left\lVert#1\right\rVert}
\newcommand{\HN}[1]{\norm{#1}_{H}}
\newcommand{\VN}[1]{\norm{#1}_{V}}
\newcommand{\VSN}[1]{\norm{#1}_{V^*}}
\newcommand{\tr}{\text{tr}}
\newcommand{\cc}{\subset\subset}
\newcommand{\emb}{\hookrightarrow}
\newcommand{\ind}[1]{\{\text{ #1 }\}}
\newcommand{\mind}[1]{$#1$}
\newcommand{\cT}{\pazocal{T}}
\newcommand{\id}{\text{Id}}
\newcommand{\te}{\theta}
\newcommand{\Te}{\Theta}

\begin{document}

% Titelseite
\pagestyle{empty}       % keine Seitennummer
  \parbox{1.5cm}{\resizebox*{110pt}{!}{\includegraphics{Logos/blau/2015_Logo_TUM_CMYK.pdf}}}\hspace{310pt}%
  \parbox{1.5cm}{\resizebox*{90pt}{!}{\includegraphics{Logos/08_Mathematik/MA_blau/FAK_MA_CMYK.pdf}}}%
\vspace*{1.5cm}
\begin{center}
{\Huge Technical University of Munich}
\\
\vspace*{1.5cm}
{\huge \textsc{Department of Mathematics}}
\\
\vspace*{3cm}
{\Huge \textbf{[Thesis Title]}}
\\
\vspace*{3cm}
{\Large Master's Thesis}\linebreak \\
{\Large von}\linebreak \\
{\Large [First Name Last Name]}\\
\vspace*{3cm}
{\Large 
\begin{tabular}{ll}
Supervisor: & Prof. Dr. [First Name Last Name]\\
Advisor: & [First Name Last Name]\\
Submission Date: & [Day. Month. Year]
\end{tabular}
}
\end{center}
\newpage    % Seitenwechsel

% Seite 2
\vspace*{18cm}
\noindent
I hereby declare that this thesis is my own work and that no other sources have been used except those clearly indicated and referenced.
\\[2cm]
Place, Date\\
original, hand-written signature
\newpage

% vertikaler Leerraum
\vspace*{2.2cm}
\noindent %kein Einzug
{\Huge \textbf{Acknowledgements}} \\
\vspace*{1.6cm} \\
% Seitennummerierung "rï¿½misch
\pagenumbering{roman}
% Kopfzeilen (automatisch erzeugt)
\pagestyle{headings}
[text of acknowledgements]

% Seite 3
\newpage
\section*{German Abstract}
[abstract text]
\section*{English Abstract}
[abstract text]
%Seite 4
\newpage
\tableofcontents  

\pagenumbering{arabic}  % Nummerierung der Seiten in 'arabisch' % neues Kapitel mit Namen "Introduction"

\chapter{Introduction}  \setcounter{page}{1}   % setzt Seitenzaehlung auf 1

\chapter{Shape derivatives}

We list here several assumptions to then formulate the shape optimization problem. For the sake of proving Gateaux differentiability, we only need to discuss concepts related to the $W^{1,\infty}$ topology.

\begin{defn}[Admissible transformations]
Let $D\subseteq \mR^n$ be a bounded Lipschitz domain. Define $\Theta:=\{\theta \in W^{1,\infty}(\mR^n,\mR^n) \text{ with } \theta|_D\in W^{2,\infty}(D;\mR^n) \text{ and } \theta=0 \text{ on } \mR^n \setminus D\}$
\end{defn}

\begin{ass}[Assumptions for the shape optimization problem]
We assume the following:
\begin{itemize}
	\item $\Omega_r \cc D $ are bounded Lipschitz domains in $\mathbb{R}^n$
	\item $\tau: \mR^n\rightarrow\mR^n$ is a map in $\cT^{1,\infty}$, with $\tau-\id \in W^{2,\infty}(D)$, $\tau -\id = 0$ on $\partial D$
\end{itemize}
\end{ass}

\appendix

\chapter{Sobolev spaces}

\begin{thm}[Integration by parts]
\label{thm:ibp}
Let $\Omega$ be a bounded Lipschitz domain. Let $1<p<\infty$ and $f,g \in W^{1,p}(\Omega), W^{1,q}(\Omega)$, $q=p'$. Then:

$$\int_\Omega f \partial_i g = -\int_\Omega g \partial_i f+\int_{\partial \Omega} \tr u \nu_i d\pazocal{H}^{n-1}$$
\end{thm}
\begin{mproof}

This follows from \cite{leoni}, theore, 18.1 at page 592, where $g$ needs to be $C^1_c(\mR^n)$. But \cite{adams}, theorem 3.18 at page 54, says that (thanks to the smoothness of the boundary) the set of the restriction of such functions is dense in $W^{1,q}(\Omega)$, so that we can conclude by a density argument \textcolor{red}{\href{https://www.math.kit.edu/iana2/lehre/sobolevspaces2021s/media/lec15.pdf}{developed here}}.

\end{mproof}

\begin{lemma}
$f \in L^\infty(\Omega; \mR^N) \iff f_i \in L^\infty$, and two equivalent norms are $\norm{f}_a:=\norm{|f|}_\infty$, $\norm{f}_b:=\max_i\norm{f_i}_\infty$, for $|\cdot |$ any finite dimensional norm.
\end{lemma}
\begin{mproof}

We choose $|\cdot |=|\cdot|_1$.

Consider $f_n \in X_a = \{[f], f: \Omega \rightarrow \mR^n \text{ measurable }, \norm{f}_a\}$, Cauchy. Then every component is Cauchy in the scalar $L^\infty$, so that $f_n^i \rightarrow f^i $ in $L^\infty$. The limit $f$ is in $X_a$ because the functions $|f_i|$ are essentially bounded, and so is $|f|$. 

Then $\norm{f_n-f}_a\leq \norm{f_n-f_m}_a+\sum_i\norm{f_m^i-f^i}_\infty$ for all $n,m$. Choose $m\geq n$ with $\norm{f_m^i-f^i}\leq 1/(Nn)$ and conclude $X_a$ is Banach.

We know from \cite{leoni}, theorem B.88 at page 671, and page 669, we know that $X_b = \{[f], f: \Omega \rightarrow \mR^n \text{ measurable }, \norm{f}_b\}$ is Banach.

Moreover $X_a=X_b$ as sets, so that the thesis follows.


%We have that $\norm{f}_\infty = \sup_{\Omega\setminus X}f$ for all $X$ null sets on which $f \leq \norm{f}_\infty$ on $\Omega \setminus X$.
%
%In fact, that  $\norm{f}_\infty \geq \sup_{\Omega\setminus X}f$ is clear, whereas suppose there is $\epsilon >0$ with $\norm{f}_\infty -\epsilon \geq f$ on $\Omega \setminus X$. Then we contradict the definition of essential supremum and therefore $\norm{f}_\infty = \sup_{\Omega\setminus X}f$.
%
%Next up: for some $X,Y \subseteq \Omega$ of measure $0$, $f,g\leq \norm{f}_\infty, \norm{g}_\infty$ in $\Omega\setminus X, \Omega \setminus Y$, therefore, for some $N$ of null measure, $f,g\leq \norm{f}_\infty, \norm{g}_\infty$ in $\Omega \setminus N$. Therefore, $\norm{f}_\infty = \sup_{\Omega \setminus N}f, \norm{g}_\infty = \sup_{\Omega \setminus N}g$. 
%
%Therefore $ \max(\norm{f}_\infty, \norm{g}_\infty) = \max(\sup_{\Omega \setminus N}f,  \sup_{\Omega \setminus N}g) = \sup_{\Omega\setminus N}\max(f,g)$.
%
%So, $N$ is a null set and $\max(f,g)\leq \max(\norm{f}_\infty, \norm{g}_\infty)$, which by the reasoning of before.
%
%

\end{mproof}

\begin{prop}[Characterization of $W^{1,\infty}$]
\label{prop:lip}
Let $\Omega$ be a bounded Lipschitz domain, or $\mathbb{R}^n$. Then $W^{1,\infty}(\Omega) = C^{0,1}\cap L^\infty(\Omega)$.

This means that $u\in W^{1,\infty}(\Omega)$ if and only if $u$ has a (unique) representative that is bounded, Lipschitz continuous. Weak and classical derivatives coincide a.e.
\end{prop}
\begin{mproof}

%\underline{ACL characterization}
%
%Let $\Omega$ be just a domain.
%
%Consider a line $\gamma$ intersecting $\Omega$. Then, the intersection is a disjoint union of open segments $\gamma_i$. We say $u\in AC_\gamma(\Omega)$ if and only if $u$ is $AC[a,b]$ for every $[a,b]\cc\eta_i$ for all $i$, for almost all lines $\eta$ parallel to $\gamma$ and intersecting $\Omega$.
%
%We say $u \in ACL(\Omega)$ if $u$ is $AC_{e_i}(\Omega)$ for all coordinate axis $e_i$. We also call $BL(\Omega)$ the set of $u$ with a representative $\tilde{u}$, with $\tilde{u}\in ACL(\Omega), \tilde{u}, \nabla \tilde{u} \in L^\infty$, $\nabla u$ being the classical (a.e.) gradient.
%
%We have the following result (see \cite{kufner}, page 276, theorem 5.6.5.): $u \in W^{1,\infty}(\Omega)$ if and only if $u$ has a representative $\tilde{u} \in BL(\Omega)$. Classical and weak derivatives then coincide a.e..

\underline{Extension}

In the case $\Omega$ is bounded Lipschitz, then $\Omega$ is an extension domain for $W^{1,\infty}(\Omega)$, meaning that there is $E: W^{1,\infty}(\Omega)\rightarrow W^{1,\infty}(\mathbb{R}^n)$ linear bounded with $Eu=u$ a.e. on $\Omega$ (see \cite{leoni}, theorem 13.17 at page 425, 13.13 at page 424, and definition 9.57 at page 273).

\underline{The proof}

Let $u \in  W^{1,\infty}(\Omega)$. By \cite{leoni}, 11.50 at page 339, because $\Omega$ is an extension domain, we obtain that $u$ has a representative $\bar{u}$ that is bounded Lipschitz. Let $\phi \in C_c^\infty(\Omega)$. By The Kirszbraun theorem (see e.g. \cite{kirszbraun}), we can extend $\bar{u}$ to a Lipschitz function $e$ on $\mathbb{R}^n$. Then, for a large enough cube $Q$ containing $\Omega$, $\ds \int_\Omega\bar{u}\partial_i\phi = \int_Q e \partial_i \phi  = -\int_Q \partial_i e \phi $, by Fubini's theorem and integration by parts for AC functions.

Because $e=\bar{u}$	on $\Omega$, we conclude $\ds \int_\Omega\bar{u}\partial_i\phi =-\int_{\Omega} \partial_i \bar{u} \phi $, so that $\nabla \bar{u} = \nabla u$ almost everywhere.

Conversely, let $u$ be bounded Lipschitz. The above reasoning shows that $u$ has essentially bounded weak derivatives equal to the a.e. classical derivatives.

\end{mproof}

\begin{cor}[$W^{k,\infty}=C^{k,1}_B$]
\label{prop:lipk}
For a bounded Lipschitz domain $\Omega$, or for $\Omega = \mR^n$, then $W^{k,\infty}=C^{k,1}_B$ ($C^{k,1}$ bounded functions with bounded derivatives).
\end{cor}
\begin{mproof}

We have already proved the case $k=1$. We prove, for instance, the case $k=2$. Then, $u \in W^{k,2} \implies u, \partial_i u \in W^{k,1}$ (\cite{leoni}, 11.7 at page 321), so that by \cref{prop:lip}, we find bounded Lipschitz $h, g_i$ with $u=h$ a.e., $\partial_i u = \partial_i h$ a.e., $g_i = \partial_i u$ a.e..

Therefore $h$ is continuous, with continuous weak derivatives $g_i$, which implies that $h \in C^1(\Omega)$ (see \textcolor{red}{\href{https://math.stackexchange.com/questions/497708/is-a-continuous-function-with-continuous-weak-derivatives-of-class-c1}{here} and \href{https://math.stackexchange.com/questions/1787716/u-continuous-and-the-weak-derivative-du-continuous-rightarrow-u-in-c1}{here}}).

Now, $\partial_i h =g_i$ a.e., so everywhere, so that:

\begin{itemize}
\item $h$ is bounded Lipschitz and $C^1$
\item $\partial_i h$ are bounded Lipschitz
\end{itemize}

%Therefore, for $\phi \in C_c^\infty(\Omega)$ we get $\ds -\int_\Omega u \phi_{,i}\ds = \int_\Omega \partial_i u\phi =  \int_\Omega g_i \phi$.
%
%Pick a cube $Q = [-M,M]^n$, $\Omega \cc Q$. So, upon extending in a bounded Lipschitz manner $g_i$ to $G_i$ with $G_i(\partial Q)=0$ (see \cite{kirszbraun} and multiply by a suitable cut-off function), and $\phi$ to $0$, we get $\ds ...=\int_\Omega G_i \phi$. Call $h_i^x(t)=G_i(...,x_{i-1},t,x_{i+1},...)$ which is $AC[-M,M]$. Because $\eta_i^x(s):= \int_{-M}^s h_i^x(z)dz$ is $AC[-M,M]$ too because $h_i^x$ is bounded, and $h_i^x(t) =  \eta_i^{x'}(t)$. Employing then Fubini:
%
%\begin{align*}
%...= \int_{-M}^M... \int_{-M}^M \int_{-M}^M G_i(...,x_{i-1},x_i,x_{i+1},...)\phi dx_i dx_1...dx_{i-1}dx_{i+1}...dx_n  \\
%= \int_{-M}^M... \int_{-M}^M \int_{-M}^M h_i^x(x_i) \phi dx_i dx_1...dx_{i-1}dx_{i+1}...dx_n \\
%= \int_{-M}^M... \int_{-M}^M \int_{-M}^M \eta_i^{x'}(x_i)  \phi dx_i dx_1...dx_{i-1}dx_{i+1}...dx_n \\
%= \int_{-M}^M... \int_{-M}^M \int_{-M}^M \eta_i^{x'}(x_i)  \phi dx_i dx_1...dx_{i-1}dx_{i+1}...dx_n \\
%= -\int_{-M}^M... \int_{-M}^M \int_{-M}^M \eta_i^x(x_i)  \phi_{,i} dx_i dx_1...dx_{i-1}dx_{i+1}...dx_n \\
%=- \int_{-M}^M... \int_{-M}^M \int_{-M}^M \int_{-M}^{x_i} G_i(...,x_{i-1},z,x_{i+1},...) dz\phi_{,i} dx_i dx_1...dx_{i-1}dx_{i+1}...dx_n \\
%= -\int_Q k_i\phi_{,i}
%\end{align*}
%
%where in the last passage we have used again Fubini and the fact that 
%
%$$k_i(x):=\int_{-M}^{x_i} G_i(...,x_{i-1},z,x_{i+1},...) dz$$
%
% is measurable and bounded on $Q$.

\end{mproof}

\chapter{Bochner spaces}

Here are some useful results about Bochner spaces.

\begin{prop}[Bochner integral and bounded operators]
\label{prop:bochner_bound}
Let $X,Y$ be separable Banach, let $T \in L(X,T)$ be a linear bounded operator. For $f \in L^1(I,X)$ define $Tf (t):= T(f(t))$. Then $Tf \in L^1(I,Y)$ with $T\int_I f = \int_I Tf$.
\end{prop}
\begin{mproof}

First of all, a clarification on the definition. What is really happening is that from the time equivalence class $f$, we select a $g$, and then $Tf(t):=T(g(t))$. $Tf$ is then the equivalence class of $t\mapsto Tf(t)$. The definition is well posed, because $g_1(t)=g_2(t)\implies T(g_1(t))=T(g_2(t))$.

Let $f_n$ be simple, $f_n\rightarrow f $ a.e., with $\lim_n \int_I f_n = \int_I f$ and $\norm{f_n}_X \leq C \norm{f}_X$ (see page 6, and corollary 2.7 at page 8 of \cite{kreuter}).

\underline{Measurability}

For almost all $t$, $T(f_n(t)) \rightarrow T(f(t))=Tf(t)$ in $Y$, so that $Tf$ is measurable (strongly).

\underline{Integrability}

By the assumptions, $\norm{Tf_n}\leq \norm{T}\norm{f_n}\leq C\norm{f}\in L^1(I)$, so that by dominated convergence (corollary 2.6 of \cite{kreuter}) $Tf$ is integrable too. Thus $\int_T Tf = \lim_n \int_I  Tf_n = \lim_n T\int_I  f_n$, because $f_n$ is simple. And now, by the choice of $f_n$, $\int_T Tf = \lim_n T\int_I  f_n = T \lim_n \int_I  f_n = T \int_I f$.

\end{mproof}

\begin{prop}	[Derivations and bounded operators]
\label{lemma:bochner_Hk_map}
As before, let $X,Y$ be separable Banach, let $T \in L(X,T)$ be a linear bounded operator.

For $k\geq 0$, $f \in H^k(I,X)\implies Tf \in H^k(I,Y)$, with weak derivatives $\partial_{t^i}Tf = T\partial_{t^i}f$, $0\leq i \leq k$.

The map $f \mapsto Tf$, $H^k(I,X)\rightarrow H^k(I,Y)$ is linear bounded.
\end{prop}
\begin{mproof}
The case $k=0$ is proved above.

We prove now that $\partial_{t^i}Tf = T\partial_{t^i}f$ for $i=1$. Note that $T\partial_t f \in L^2(I,Y)$, which qualifies as weak derivative.

In fact, for $\phi \in C_c^\infty(I)$, we have $\int_I \phi T\partial_i f = \int_I T(\phi\partial_t f) = T \int_I\phi\partial_t f = -T\int_I\phi'f=-\int_I\phi'Tf$.

Higher weak derivatives are treated analogously and the rest of the claims follow from the time stationarity of $T$ and by $\norm{\partial_{t^i}Tf}=\norm{T\partial_{t^i}f}\leq \norm{T}\norm{\partial_{t^i}f}$.

\end{mproof}

\begin{prop}[Continuous representatives]
\label{prop:cts_repr}
Let $X$ be separable Banach. $f \in L^1(I,X)$ has at most a continuous representative on $[0,T]$.
\end{prop}
\begin{mproof}
Assume there exists two such continuous representatives, so that we get a function $\delta: [0,T] \rightarrow X$ that is zero almost everywhere and continuous. Hence, $[0,T] \ni t \mapsto \norm{\delta(t)}$ is continuous in $\mR$ and zero a.e., so that it must be zero everywhere.
\end{mproof}

%\begin{prop}[Weak derivatives and Gelfand triples]
%\label{prop:sob_implies_W}
%Let $H\subseteq V$ be separable Hilbert spaces, $H$ densely embedded in $V$.
%
%Then $y \in L^2(I,V)\cap H^1(I,H) \subseteq W(I,V)$.
%\end{prop}
%\begin{mproof}
%We note that $V$ is Hilbert separable, so, reflexive Banach and separable, so that $V^*$ is separable too. Then, call $i$ the embedding $H \emb V^*$.
%
%For $\phi \in C^\infty_c(I)$ we obtain $\int_I i(y_t)\phi=\int_I i(y_t\phi)= i \left ( \int_I y_t\phi \right )$ by \cref{prop:bochner_bound}. Therefore $\int_I i(y_t)\phi=-i \left ( \int_I y\phi' \right ) =\int_I i(y)\phi'  $ , proving that $y \in W(I,V)$.
%
%\end{mproof}

We now check that a vector valued test function has weak derivatives of all orders.

\begin{prop}[Weak derivatives of test functions]
\label{prop:weak_class}
Let $\phi \in C^1([0,T],X)$, for $X$ separable Banach. It means that the limit of the difference quotients exists for all points of $I$, that $t\mapsto \phi(t), \phi'(t)$ are continuous, and that they can be continuously extended to $[0,T]$.

Then these classical derivatives coincide a.e. with the weak derivatives of $u$.

\end{prop}
\begin{mproof}


We rely on proposition 3.8 of \cite{kreuter} at page 26.

\underline{Absolute continuity}

Consider $\epsilon >0$. Divide $[a,b] \cc (0,T)$ into a uniform partition $t_i$. By theorem 6 at page 146 of \cite{mvt}, we get that $\ds \norm{\phi(t_i)-\phi(t_{i-1})}_X \leq (t_i-t_{i-1})\norm{\phi(\xi_i)}_X\leq (b-a) \norm{\phi'}_{\infty}/n$, and by choosing $n$ small enough, we conclude that $\phi$ is (locally) absolutely continuous.

\underline{Weak derivative}

Therefore, $\phi$ is locally $AC$, differentialble everywhere and $\phi'$ is bounded, so that $\phi \in H^1(I,X)$ and weak and classical derivatives coincide. 

\end{mproof}

And now, introduce a time dependent version of the trace operator which is useful for our computations.

\begin{defn}[Time dependent trace]
Let $\Omega$ be a bounded Lipschitz domain. For $k\geq 0$ we define $\tr: H^k(I,H^1(\Omega))\rightarrow H^k(I, H^{1/2} (\partial \Omega))$ by $\tr(u)(t):=\tr(u(t))$
\end{defn}

Below are some properties of this operator.

\begin{prop}[Properties of trace operator]
\label{prop:trace}
The trace operator just defined:
\begin{enumerate}
\item is well posed
\item is linear bounded
\item admits a linear bounded right inverse, for instance, $E(g)(t):=E(g(t))$ (for $E$ a right inverse of the static trace)
\item $\tr$ and $E$, in the case of $k \in \mathbb{N}_0$, coincide (in the time a.e. sense) for the case $l\geq k$
\item for $k\geq 1$, $\tr u(0)=0 \iff u(0)=0$ (in the sense of continuous representatives)
\item it coincides with the trace treated for instance in \cite{lions}
\end{enumerate}
\end{prop}
\begin{mproof}

\underline{Proof of the proposition}

We recall that the trace operator is bounded surjective onto $H^{1/2}(\partial \Omega)$, with a right inverse $E$ (see theorem 3.37 at page 102 of \cite{mclean}).

The first three points are consequences of this fact and of \cref{prop:bochner_bound}.

The fourth property follows by the definition of $\tr, E$ and the fact that $H^l\subseteq H^k$, for $k\leq l$.

Let now $k\geq 1$. We know that $H^1, H^{1/2}$ are separable and Banach (the latter is separable because the continuos image of $H^1$ separable, and Banach (see \cite{grisvard}, page 20). Therefore, by \cite{evans}, theorem 2 of page 286, we obtain the embeddings $H^k(I,H^1)\emb C([0,T],H^1)$ and the same goes for $H^k(I,H^{1/2})$. The embedding is $U$, the unique continuous representative of a certain time equivalence class (\cref{prop:cts_repr}). We also introduce brackets to indicate equivalence classes in time, so, $u = [Uu]$.

We want to prove $(Uu)(0)=0 \iff U(\tr u)(0)=0$. But we have $[t \mapsto U(\tr u )(t)]=tru:=[t \mapsto \tr((Uu)(t))]$. So, $U(\tr u )(t)=\tr((Uu)(t))$ for all $t\in[0,T]$ by continuity. 

For the last point, let $k=0$. We have:

\begin{enumerate}
\item $H^1(\Omega)\cap C^1(\overline{\Omega})$ is dense in $H^1(\Omega)$ (see \cite{adams}, theorem 3.18 at page 54, where being $\Omega$ bounded Lipschitz is important)
\item functions $\sum_{i\leq m} \phi_i(t)f_i$ for $\phi_i \in C_c^\infty(I), f_i \in H^1(\Omega)\cap C^1(\overline{\Omega})$ are dense in $L^2(I,H^1)$ (see \cite{hinze}, page 39, lemma 1.9)
\end{enumerate}

It follows by the third point that $C^1(\overline{\Omega\times I})$ is dense in $L^2(I,H^1)$, so that $u\mapsto u|_{I\times \partial \Omega}$ admits a unique extension by continuity to $L^2(I,H^1)$, so that this definition of trace coincides with the one from the literature in the case of the space $H^{1,0}:=L^2(I,H^1)$ (see \cite{lions}, theorem 4.1), we expand this argument below.

\underline{Proof of leftover facts}

We call $C^k(\overline{\Omega}):=\{u \in C^k(\Omega) \text{ with }\partial_\alpha f \text{ extendable by continuity to } \overline{\Omega} \}$. 

Consider $u(x,t):=\phi(t)v(x)$, for $\phi \in C^1([0,T]), v \in C^1(\overline{\Omega})$. Then, it has partial derivatives $u_t = \phi_t v, u_i = \phi u_i$. $u$ and all its partial derivatives are continuous on $I\times \Omega$, meaning that $u \in C^1(\Omega \times I)$.

Moreover, $u, u_i, u_t \in C([0,T], C(\overline{\Omega}))$. We claim $ C([0,T], C(\overline{\Omega})) = C(\overline{\Omega\times I})$. In fact, one direction is trivial, and so, let $f \in C([0,T], C(\overline{\Omega})) = C(\overline{\Omega})$. Fix $(t,x) \in \overline{\Omega\times I}$. Then, $|f(s,y)-f(t,x)|\leq |f(t,y)-f(t,x)|+|f(t,y)-f(s,y)|\leq  |f(t,y)-f(t,x)|+\norm{f(t, \cdot)-f(s,\cdot)}_{\infty}$. If now $s$ is close to $t$, and $y$ is close to $x$, then $|f(s,y)-f(t,x)|$ is small.

This shows $u, u_i, u_t \in C([0,T], C(\overline{\Omega})) \in C(\overline{\Omega\times I}) $, i.e. $u \in C^1(\overline{Q\times I})$.

To conclude, let $u \in L^2(I,H^1)$. Approximate $u$ by $u_k:=\sum_{i\leq m_k} \phi_i^k(t)f_i^k$ as in point 2, and approximate $f_i^k$ by suitable $g_i^k \in H^1(\Omega)\cap C^1(\overline{\Omega})$, to obtain $u_k:=\sum_{i\leq m_k} \phi_i^k(t)g_i^k$

Then $\norm{u-w_k}_{L^2(I,H^1)}\leq \norm{u_k-w_k}_{L^2(I,H^1)}+\norm{u_k-u}_{L^2(I,H^1)}$. We only need to estimate $ \norm{u_k-w_k}_{L^2(I,H^1)}\leq\ds  T \sum_{i\leq m_k} \norm{\phi_i^k}_\infty\norm{f_i^k-g_i^k}_{H^1}$. By the first point, $\norm{f_i^k-g_i^k}_{H^1}$ can be made as small as it is necessary to conclude.

\underline{Last remarks}

Again with reference to \cite{lions}, consider the anisotropic spaces $H^{r,s}:=L^2(I,H^r)\cap H^s(I,L^2)$. We restrict to the case $r = 1$, $s\geq 0$. Denote the traces $\tr_s$ defined in theorem 4.1, mapping $H^{1,s}(\Omega \times I)\rightarrow H^{1/2, s/2}(\partial \Omega \times I)$. For $\partial \Omega$ Lipschitz this theorem is still valid, as $1/2\leq 1$, see the discussion above lemma 2.4 in \cite{costabel}. As stated in \cite{lions}, $\tr_s$ is an extension of  $u\mapsto u|_{I\times \partial \Omega}$, defined on the dense suspace $C^\infty(\overline{Q\times I})$ of $H^{1,s}$ (that this space is dense can be proved as in lemma 2.22 of \cite{costabel}). So, let $C^\infty(\overline{Q\times I})\ni u_n \rightarrow_{H^{r,s}} u \in H^{1,s}$.
 
We have $\tr_s u_n = \tr_0 u_n$. Then, $u_n \rightarrow_{H^{1,s}} u$, $u_n \rightarrow_{H^{1,0}} u$, so that $\tr_s u_n \rightarrow_{H^{1/2,s/2}}\tr_s u$ (hence $\tr_0 u_n \rightarrow_{H^{1/2,0}}\tr_s u$) and $\tr_0 u_n  \rightarrow_{H^{1/2,0}} \tr_\sigma u$.

Thus $\tr_0 u = \tr_s u$.

Using what we derived before, we can conclude the characterization of the traces in the anisotropic settign define 

\end{mproof}

And now some sanity checks in the case of Gelfand triples. 

\begin{prop}[Sanity checks for Gelfand triples]
\label{prop:sanity}

Consider the following Gelfand triples (the diagram commutes):

\[\begin{tikzcd}
	{V} &&& {V^*} \\
	& H & {H^*} \\
	{W} &&& {W^*}
	\arrow["c", hook, from=3-1, to=1-1]
	\arrow["a", hook, from=1-1, to=2-2]
	\arrow["b"', hook, from=3-1, to=2-2]
	\arrow["{a^*}", hook, from=2-3, to=1-4]
	\arrow["r", from=2-2, to=2-3]
	\arrow["{b^*}"', hook, from=2-3, to=3-4]
	\arrow["{c^*}", hook, from=1-4, to=3-4]
\end{tikzcd}\]

Here $W\subseteq V \subseteq H$ are all separable Hilbert spaces, $a,b,c$ the trivial injections, $r$ the Riesz isomorphism of $H$. We denote by $i_V$ the Gelfand triple embedding $V\emb V^*$, so, $i_V=a^*ra$.

Then:

\begin{enumerate}
	\item $H^1(I,V)\subseteq W(I,V)$ with continuous embedding. The $W(I,V)$ derivative of $u \in H^1(I,V)$ is $i_V u_t$.
	\item for $u \in W(I,W)$ with $(i_W u)'\in L^2(I,H)$ (i.e. $(i_W u)_t = b^*r h$ for $h$ in $L^2(I,H)$) we obtain $u \in W(I,V)$ (i.e. $cu \in W(I,V)$), with derivative $(i_V cu)'=a^*r h$, so that also $(i_V cu)' \in L^2(I,H)$. It also holds $(i_V cu)'|_W = (i_W u)'$. $h$ is also the weak derivative $L^2(I,H)$ of $bu$.
	\item let $u, v \in W(I,V)$ with $u-v \in W$. Then $u-v \in W(I,W)$ with derivative $(i_W(u-v))'=(i_V u)'|_W-(i_V v)'|_W$.
\end{enumerate}

\end{prop}
\begin{mproof}

We use several times that time integrals and bounded linear static operators commute, see \cref{prop:bochner_bound}. $\phi$ denotes $\phi \in C^\infty_c(I)$.

\underline{First point}

We need to check that $a^* r a u \in H^1(I, V^*)$. This follows from \cref{lemma:bochner_Hk_map}, so that $(a^* r a u)_t = a^* r a u_t$.

\underline{Second point}

At first we claim that $h$ is a weak derivative of $bu \in L^2(I,H)$. In fact, $b^* r \int_I bu \phi' = \int_I (i_W u)\phi' = \ind{\mind{u \in W(I,W)}} =-\int_I(i_Wu)'\phi=-\int_I b^*r h\phi = b^*r (-\int_I h \phi)$. By density (definition of Gelfand triple), $b^*$ is injective, $r$ is too, and thus $\int_I bu \phi' = -\int_I h \phi$, which shows that $bu$ has weak derivative $h$, in the $H^1(I,H)$ sense.

And now $\int_I i_V c u \phi'= \int_I a^*racu \phi' = a^*r\int_I bu\phi' = \ind{by what we just proved}=-a^*r \int_I h \phi$, proving that $(i_V cu)'=a^*r h$.

Morevoer $(i_V cu)'|_W = c^*a^*r h=b^*rh=\ind{assumption} = (i_W u)'$.

\underline{Third point}

We check the derivative. We have $\int_i i_W(u-v)\phi' =\ind{\mind{u-v \in W\subseteq V}} = \int_I b^* r a (u-v) = c^*\int_I(i_Vu - i_Vv)\phi' = -\int c^*((i_V u)'- (i_V v)')\phi$.

\end{mproof}

\chapter{Parabolic equations}

\begin{ass}[Basic assumption for parabolic problems]
\label{ass:basic_par}

Let $V\subseteq H$ be real separable Hilbert spaces, $V$ dense in $H$. Then $H\hookrightarrow V^*$ is also dense, as stated in \cite{trol} at page 147. This embedding is $H \ni f \mapsto (f, \cdot )_H$. We thus obtain a Gelfand triple, and we have $W(I,V)\subseteq C(I,H)$.

Let $A:V\rightarrow V^* $ be linear bounded, $u \in W(I;V)$, $f \in L^2(I,V^*)$ and $u_0 \in H$.

We also assume that $\langle Av, v \rangle_{V^*,V}+ \lambda \HN{v}^2\geq \alpha \VN{v}^2$ for $\lambda \geq 0, \alpha >0$.
\end{ass}

We are interested in the following problem:

\begin{pb}[Abstract parabolic equation]
\label{eqn:general_parabolic}
\begin{align}
	u_t+Au=f \text{ in }V^* \text{ and for a.e. } t \in (0,T)\\
	u(0)=u_0
\end{align}
\end{pb}

\begin{thm}[Basic well posedness of \cref{eqn:general_parabolic}]
\label{thm:well_pos_parabolic}
Under \cref{ass:basic_par}, \cref{eqn:general_parabolic} has a unique solution $u$. Moreover $u$ satisfies the energy estimate:
\begin{equation}
	\label{eqn:en_est}
	\norm{u}_{W(I,V)} + \norm{u}_{C([0,T],H)}\leq c(\lambda, \alpha, \VSN{A}, T)(\HN{u_0}+\norm{f}_{L^2(I,V^*)})
\end{equation} 
\end{thm}
\begin{mproof}
See \cite{gilardi} at page 19, theorem 26.
\end{mproof}

We can also obtain additional regularity. Here are further assumptions to make this possible.

\begin{ass}[Assumptions for additional regularity]
\label{ass:reg_par}
We assume $u_0 \in V$, $f = f_1+f_2 \in L^2(I,H)+H^1(I,V^*)$. We also need $A$ to be symmetric (i.e. $\langle Au,v \rangle_{V^*,V} = \langle Av,u \rangle_{V^*,V}$).
\end{ass}

\begin{thm}[Regularity of time derivative]
\label{thm:reg_time}
Suppose \cref{ass:basic_par} and \cref{ass:reg_par}. Then $u_t \in L^2(I, H)$ with the estimate:
\begin{align}
	\norm{u}_{W(I,V)} + \norm{u}_{C(I,H)} + \norm{u_t}_{L^2(I,H)} \leq\\ c(\lambda, \alpha, \VSN{A}, T)(\VN{u_0}+\norm{f_1}_{L^2(I,H)} + \norm{f_2}_{H^1(I,V^*)})
\end{align}

That $u_t \in L^2(I, H)$ means precisely that there is $h \in L^2(I,H)$ with $a^* r h = (i_V u)'$, with the notation introduced in \cref{prop:sanity}.

\end{thm}
\begin{mproof}
We refer to page 26 of \cite{gilardi}, theorem 28, and only prove the necessary modifications.

\underline{Product rule for $A$}

We have 

\begin{align*}
\int_0^t \langle Au_n,u_n' \rangle_{V^*,V} = \sum_{k,l\leq n} \langle Aw^n_k,w^n_l \rangle_{V^*,V} \int_0^t g_k^n g_l^{n '} = \\
\sum_{k,l\leq n} \langle Aw^n_k,w^n_l \rangle_{V^*,V} \left (-\int_0^t g_k^{n'} g_l^n + g_k^n(t) g_l^n(t)-g_k^n(0) g_l^n(0) \right )
\end{align*}

By linearity at first and then symmetry we get:

\begin{align*}
	= \langle Au_n,u_n \rangle_{V^*,V}(t)-\langle Au_n,u_n' \rangle_{V^*,V}(0)-\int_0^t\langle Au_n',u_n \rangle_{V^*,V}=\\
	= \langle Au_n,u_n \rangle_{V^*,V}(t)-\langle Au_n,u_n' \rangle_{V^*,V}(0)-\int_0^t\langle Au_n,u_n' \rangle_{V^*,V}
\end{align*}

so that:

\begin{align*}
	\int_0^t \langle Au_n,u_n' \rangle_{V^*,V} = \frac{1}{2}\left( \langle Au_n,u_n \rangle_{V^*,V}(t)-\langle Au_n,u_n' \rangle_{V^*,V}(0) \right )
\end{align*}

\underline{Estimate for right hand side}

We have:

\begin{align*}
	\int_0^t \langle f_2,u_n' \rangle_{V^*,V} = \sum_{k\leq n}\int_0^tg_k^{n'}\langle f_2,w_k^n \rangle_{V^*,V}
\end{align*}

By the smoothness of $f_2$ we have that $t \mapsto \langle f_2(t),w_k^n \rangle_{V^*,V}$ is $H^1(0,T)$, in particular $AC[0,t]$, so that we can integrate by parts:

\begin{align*}
	 = - \sum_{k\leq n}\int_0^tg_k^{n}\langle f_2',w_k^n \rangle_{V^*,V} + \sum_{k\leq n} g_k^{n}(t)\langle f_2(t),w_k^n \rangle_{V^*,V} - \sum_{k\leq n} g_k^{n}(0)\langle f_2(0),w_k^n \rangle_{V^*,V} = \\
	 -\int_0^t \langle f_2',u_n \rangle_{V^*,V} + \langle f_2,u_n \rangle_{V^*,V}(t)-\langle f_2,u_n \rangle_{V^*,V}(0)=
\end{align*}

Here we have used \cref{lemma:bochner_Hk_map} to take the derivative inside the bracket.


Going to the absolute values:

\begin{align*}
	\left | \int_0^t \langle f_2,u_n' \rangle_{V^*,V}\right | \leq 
	\int_0^T |\langle f_2',u_n \rangle_{V^*,V}|+ \VSN{f_2(t)}\VN{u_n(t)}+\VSN{f_2(0)}\VN{u_n(0)} \leq \\
	\frac{1}{2}\norm{f_2'}_{L^2(I,V^*)}^2 + \frac{1}{2}\norm{u_n}_{L^2(I,V)}^2 + \frac{\alpha}{4}\VN{u_n(t)}^2 +\\
	+ \frac{4}{\alpha}\norm{f_2}_{L^\infty(I,V^*)}^2+ \frac{1}{2}\norm{f_2}_{L^\infty(I,V^*)}^2+\frac{1}{2}\VN{u_{n0}}^2
\end{align*}

Now, $u_n$ converges weakly in $L^2(I,V)$ by estimate (59) of \cite{gilardi} and thus $\frac{1}{2}\norm{u_n}_{L^2(I,V)}$ is bounded. The term $\frac{\alpha}{4}\VN{u_n(t)}$ can be pulled to the left hand side, $u_{0n}$ is $V$ convergent hence bounded. Therefore as in \cite{gilardi} we are able to conclude that $u_n'$ is bounded in $L^2(I,H)$. We want to conclude $u_t \in L^2(I,H)$. We know for sure that $\langle u_m',w_j\rangle_{V^*,V}=\langle f-Au_m,w_j\rangle_{V^*,V}$, so that muliplication by a test function and integration yields $\int_I \langle u_m',w_j\phi\rangle_{V^*,V}=\int_I \langle f-Au_m,w_j\phi\rangle_{V^*,V}$. Because $u_m\rightharpoonup u$ in $L^2(I,V)$ we observe that, by \cref{prop:bochner_bound} applied on $A \in L(V,V^*)$, it holds $\int_I \langle u_m',w_j\phi\rangle_{V^*,V}\rightarrow \int_I \langle u',w_j\phi\rangle_{V^*,V}$.

What's more, is that $u_m' \rightharpoonup h$ in $L^2(I,H)$, so that $\int_I \langle h ,w_j\rangle_{V^*,V}\phi = \int_I \langle u',w_j\rangle_{V^*,V}\phi$. It means that for almost all $t$, $\langle h ,w_j\rangle_{V^*,V} = \langle u',w_j\rangle_{V^*,V}$. And now we can really say that $u' \in L^2(I,H)$, which even more precisely means $(i_Vu)' = a^* r h$ almost everywhere.

We also obtain that $u_t$ is bounded by $c(\alpha)(\norm{f_2}_{L^\infty(I,V^*)}+\norm{f_2}_{L^2(I,V^*)}+\VN{u_0}+\norm{u}_{L^2(I,V)})$.

Note that, by \cite{evans}, theorem 2 of page 286, we can estimate $\norm{f_2}_{L^\infty(I,V^*)}$ by $c(T)\norm{f_2}_{H^1(I,V^*)}$, so that the claim for the time derivative $u_t$ is proven.

\end{mproof}

For the case where $H=L^2$, $H^1\supseteq V\supseteq H^1_0$,  $f_2|_{H^1_0}=0$ we have even more regularity available.

\begin{thm}[Additional regularity]
\label{thm:par_reg}
Suppose \cref{ass:basic_par} and \cref{ass:reg_par}. 

Let additionally $H=L^2$, $H^1\supseteq V\supseteq H^1_0$,  $f_2|_{H^1_0}=0$. Then $Au|_{H^1_0}$ extends to $\overline{Au_{H^1_0}} \in L^2(I,H)$ with:
\begin{align}
	\norm{u}_{W(I,V)} + \norm{u}_{C([0,T],H)} + \norm{u_t}_{L^2(I,H)} +\norm{\overline{Au|_{H^1_0}}}_{L^2(I,H)}\leq\\ c(\lambda, \alpha, \VSN{A}, T)(\VN{u_0}+\norm{f_1}_{L^2(I,H)} + \norm{f_2}_{H^1(I,V^*)})
\end{align}

Moreover $u_t+\overline{Au_{H^1_0}}=f_1$ in $L^2(0,T,L^2)\cong L^2(Q)$ and $\overline{Au|_{H^1_0}}=Au$ on $H^1_0$.

\end{thm}
\begin{mproof}

For $v \in H^1_0$ we get $ \langle Au,v \rangle_{V^*,V} =  \langle f_1-u_t,v \rangle_{V^*,V} = ( f_1-u_t,v )_H$, for almost all $t \in (0,T)$. From here we conclude that $Au(t)$ extends for a.a. $t$ to an element of $H$ with $(\overline{Au}-f_1+u_t,v)_{L^2}=0$ for all $v \in H^1_0$, almost all $t$. By density, $\overline{Au}-f_1+u_t=0$ in $H$ for almost all $t$, so that $\overline{Au}=f_1-u_t$ in $L^2(0,T,L^2)\cong L^2(Q)$.

This isometric isomorphism is stated in \cite{trol}, page 144. 

\end{mproof}

For our applications we also need to track the constants more precisely, which is accomplished in the next proposition.

\begin{prop}[Tracking the costants]
\label{thm:const_track}
With \cref{ass:basic_par} there holds:
\begin{align}
\norm{u}^2_{C([0;T],H)}+\alpha\norm{u}_{L^2(I,V)}^2\leq \exp(2\lambda T)(\HN{u_0}^2+\alpha^{-1}\norm{f}^2_{L^2(I,V^*)})\\
\norm{u'}_{L^2(I,V^*)}\leq \norm{A}_{L(V,V^*)}\alpha^{-1/2}\sqrt{\exp(2\lambda T)}\HN{u_0} +\\\left (\norm{A}_{L(V,V^*)}\alpha^{-1}\sqrt{\exp(2\lambda T)}+1\right ) \norm{f}_{L^2(I,V^*)}
\end{align}

With additionally \cref{ass:reg_par} we obtain:

\begin{align}
C\norm{u'}^2_{L^2(I,H)}\leq 
(1+(1+C_0)\alpha^{-1})\norm{f_2}_{H^1(I,V^*)}^2+\\
(1+\norm{A}_{L(V,V^*)})\VN{u_{0}}^2+C_0\HN{u_0}^2+\\
\norm{f_1}_{L^2(I,H)}^2+C_0\alpha^{-1}\norm{f_1}^2_{L^2(I,V^*)}
\end{align}

with $C>0$ a number independent of the problem.

Here $C_0 = \ds 2^{-1}\max(1,\lambda)\max(1,\alpha^{-1})\exp(2\lambda T)$.

\end{prop}
\begin{mproof}

\underline{No regularity}

From page 21 of \cite{gilardi} we obtain that $\norm{u}^2_{C([0;T],H)}+\alpha\norm{u}_{L^2(I,V)}^2\leq \exp(2\lambda T)(\HN{u_0}^2+\alpha^{-1}\norm{f}^2_{L^2(I,V^*)})$.

In particular, $\sqrt{\alpha}\norm{u}_{L^2(I,V)}\leq 	\sqrt{\exp(2\lambda T)}(\HN{u_0}+\alpha^{-1/2}\norm{f}_{L^2(I,V^*)})$, or $\norm{u}_{L^2(I,V)}\leq 	\alpha^{-1/2}\sqrt{\exp(2\lambda T)}(\HN{u_0}+\alpha^{-1/2}\norm{f}_{L^2(I,V^*)})$.

Moreover $\norm{u'}_{L^2(I,V^*)}\leq \norm{Au}_{L^2(I,V^*)}+\norm{f}_{L^2(I,V^*)}\leq \norm{A}\norm{u}_{L^2(I,V)}+\norm{f}_{L^2(I,V^*)}$.

All in all, we obtain:

$$\norm{u}^2_{C([0;T],H)}+\alpha\norm{u}_{L^2(I,V)}^2\leq \exp(2\lambda T)(\HN{u_0}^2+\alpha^{-1}\norm{f}^2_{L^2(I,V^*)})$$

and:

$$\norm{u'}_{L^2(I,V^*)}\leq \norm{A}_{L(V,V^*)}	\alpha^{-1/2}\sqrt{\exp(2\lambda T)}(\HN{u_0}+\alpha^{-1/2}\norm{f}_{L^2(I,V^*)})+\norm{f}_{L^2(I,V^*)}$$

\underline{More regularity}

We tie back to page 25 of \cite{gilardi}. In particular:

\begin{align*}
\int_0^t\HN{u_n'}^2+\int_0^t\langle A u_n, u_n'\rangle_{V^*,V}=\int_0^t(f_1,u_n')_H+\int_0^t \langle f_2, u_n'\rangle_{V^*,V}
\end{align*}

%Now, taking $u_{n0}$ to be the orthogonal projection of $u_0$ onto $V_n$ with the scalar product of $V$, we can assume $\VN{u_{n0}}\leq\VN{u_0}$.

Then:
\begin{align*}
\int_0^t\langle A u_n, u_n'\rangle_{V^*,V}\geq \frac{\alpha}{2}\VN{u_n(t)}^2-\frac{\lambda}{2}\HN{u_n(t)}^2-\frac{\norm{A}}{2}\VN{u_{n0}}
\end{align*}

whereas, as in the proof of \cref{thm:reg_time}:
\begin{align*}
	\left | \int_0^t \langle f_2,u_n' \rangle_{V^*,V}\right | \leq
	\frac{1}{2}\norm{f_2'}_{L^2(I,V^*)}^2 + \frac{1}{2}\norm{u_n}_{L^2(I,V)}^2 + \frac{\alpha}{4}\VN{u_n(t)}^2 +\\
	+ \frac{4}{\alpha}\norm{f_2}_{L^\infty(I,V^*)}^2+ \frac{1}{2}\norm{f_2}_{L^\infty(I,V^*)}^2+\frac{1}{2}\VN{u_{n0}}^2
\end{align*}

Also:
\begin{align*}
\int_0^t(f_1,u_n')_H\leq \frac{1}{2}\norm{f_1}_{L^2(I,H)}^2+\frac{1}{2}\int_0^t\HN{u_n'}^2
\end{align*}

Putting all together:

\begin{align*}
\int_0^t\HN{u_n'}^2+\frac{\alpha}{2}\VN{u_n(t)}^2-\frac{\lambda}{2}\HN{u_n(t)}^2-\frac{\norm{A}}{2}\VN{u_{n0}} \\
\frac{1}{2}\norm{f_2'}_{L^2(I,V^*)}^2 + \frac{1}{2}\norm{u_n}_{L^2(I,V)}^2 + \frac{\alpha}{4}\VN{u_n(t)}^2 +\\
+ \frac{4}{\alpha}\norm{f_2}_{L^\infty(I,V^*)}^2+ \frac{1}{2}\norm{f_2}_{L^\infty(I,V^*)}^2+\frac{1}{2}\VN{u_{n0}}^2+\\
+ \frac{1}{2}\norm{f_1}_{L^2(I,H)}^2+\frac{1}{2}\int_0^t\HN{u_n'}^2
\end{align*}

which brings us to:

\begin{align*}
\frac{1}{2}\int_0^t\HN{u_n'}^2+\frac{\alpha}{4}\VN{u_n(t)}^2-\frac{\lambda}{2}\HN{u_n(t)}^2\leq \\
\frac{1}{2}\norm{f_2'}_{L^2(I,V^*)}^2 + \frac{1}{2}\norm{u_n}_{L^2(I,V)}^2 +\\
+ \frac{8+\alpha}{2\alpha}\norm{f_2}_{L^\infty(I,V^*)}^2+\frac{1+\norm{A}}{2}\VN{u_{n0}}^2+\\
+\frac{1}{2}\norm{f_1}_{L^2(I,H)}^2
\end{align*}

and thus, because norms are lower semicontinuous and because we have weak convergence of the time derivative, and $V$-strong convergence of the initial data:

\begin{align*}
\frac{1}{2}\int_0^T\HN{u'}^2\leq 
\frac{1}{2}\norm{f_2'}_{L^2(I,V^*)}^2 
+ \frac{8+\alpha}{2\alpha}\norm{f_2}_{L^\infty(I,V^*)}^2+\frac{1+\norm{A}}{2}\VN{u_{0}}^2+
\frac{1}{2}\norm{f_1}_{L^2(I,H)}^2+\\
\text{limsup}_n \left ( \frac{\lambda}{2}\norm{u_n}_{C([0,T],H)}^2 + \frac{1}{2}\norm{u_n}_{L^2(I,V)}^2 \right )
\end{align*}

Using a purely numeric constant $C$  without dependences on the problem we can write:

\begin{align*}
\int_0^T\HN{u'}^2\leq 
\norm{f_2'}_{L^2(I,V^*)}^2+C(1+\alpha^{-1})\norm{f_2}_{L^\infty(I,V^*)}^2+C(1+\norm{A})\VN{u_{0}}^2+\norm{f_1}_{L^2(I,H)}^2+\\
C\text{limsup}_n \left ( \frac{\lambda}{2}\norm{u_n}_{C([0,T],H)}^2 + \frac{1}{2}\norm{u_n}_{L^2(I,V)}^2 \right )
\end{align*}


For the last term, employing the exact argument as in the first part of the proof:

\begin{align*}
\text{limsup}_n \left ( \frac{\lambda}{2}\norm{u_n}_{C([0,T],H)}^2 + \frac{1}{2}\norm{u_n}_{L^2(I,V)}^2 \right )\leq\\
2^{-1}\max(1,\lambda)\max(1,\alpha^{-1}) \text{limsup}_n \left ( \norm{u_n}_{C([0,T],H)}^2 + {\alpha}\norm{u_n}_{L^2(I,V)}^2 \right )\leq\\
2^{-1}\max(1,\lambda)\max(1,\alpha^{-1})\exp(2\lambda T)(\HN{u_0}^2+\alpha^{-1}\norm{f_1+f_2}^2_{L^2(I,V^*)}) \leq \\
2^{-1}\max(1,\lambda)\max(1,\alpha^{-1})\exp(2\lambda T)(\HN{u_0}^2+2\alpha^{-1}\norm{f_1}^2_{L^2(I,V^*)}+2\alpha^{-1}\norm{f_2}^2_{L^2(I,V^*)}) \leq \\
C C_0(\HN{u_0}^2+\alpha^{-1}\norm{f_1}^2_{L^2(I,V^*)}+\alpha^{-1}\norm{f_2}^2_{L^2(I,V^*)})
\end{align*}


where $C_0 = \ds 2^{-1}\max(1,\lambda)\max(1,\alpha^{-1})\exp(2\lambda T)$ and $C$ is a purely numeric constant without dependences on the problem.

Therefore:

\begin{align*}
C\int_0^T\HN{u'}^2\leq 
\norm{f_2'}_{L^2(I,V^*)}^2+(1+\alpha^{-1})\norm{f_2}_{L^\infty(I,V^*)}^2+(1+\norm{A})\VN{u_{0}}^2+\norm{f_1}_{L^2(I,H)}^2+\\
C_0(\HN{u_0}^2+\alpha^{-1}\norm{f_1}^2_{L^2(I,V^*)}+\alpha^{-1}\norm{f_2}^2_{L^2(I,V^*)})
\end{align*}


The embedding $H^1(I,V^*)\emb C([0,T],V^*)$ has norm that only depends on $T$, which follows from the equality $f_2(t)=f_2(s)+\int_s^tf_2'$, for $0\leq s \leq t \leq T$, a bound being $1+T$.

Thus:

\begin{align*}
C\int_0^T\HN{u'}^2\leq 
(1+(1+C_0)\alpha^{-1})\norm{f_2}_{H^1(I,V^*)}^2+\\
(1+\norm{A})\VN{u_{0}}^2+C_0\HN{u_0}^2+\\
\norm{f_1}_{L^2(I,H)}^2+C_0\alpha^{-1}\norm{f_1}^2_{L^2(I,V^*)}
\end{align*}


\end{mproof}

\section{Application to inhomogeneous parabolic problems}

\subsection{Inhomogeneous Dirichlet problem}

We make the following assumption.

\begin{ass}[Assumptions for \cref{pb:diri}]
\label{ass:diri}
We assume $\Omega \cc D $ to be bounded Lipschitz domains, so that $U:=D\setminus \Omega$ is bounded Lipschitz too and  the trace operator is bounded surjective onto $H^{1/2}(\partial U)$, with a right inverse $E$ (see theorem 3.37 at page 102 of \cite{mclean}). For such a choice we also have $H^1_0=H^1\cap \text{ker }\tr$, see \cite{leoni}, page 595, theorem 18.7.

Moreover, we select $f \in H^1(I, H^{1/2}(\Gamma_f))$, $f(0)=0$.
\end{ass}

Note that, given a bounded extension operator $E: H^{1/2}(\partial U) \rightarrow H^1(U)$, we obtain by \cref{lemma:bochner_Hk_map} that $Ef \in H^2(I, H^1(U))$. We have defined $\tr u (t):= tr(u(t))$ and analogously $Eu(t):=E(u(t))$ (see \cref{prop:trace}).

Call $H=L^2(U)$, $V=\{ v \in H^1(U), \tr u = 0 \text{ on } \Gamma_m\}=:H^1_c$. $V$ is a closed subspace of $H^1$, which is Hilbert separable, hence also Hilbert separable. We norm it with the full $H^1$ norm. Because $H^1_0(U)$ is dense in $H$, so is $V$ and we obtain a Gelfand triple. That $V$ is a closed subspace of $H^1$ follows from the observation that if $u_n\rightarrow u$ in the $V$ norm, then $\tr u_n \rightarrow \tr u$ in $L^2(\partial U)$. We can take an almost everywhere pointwise convergent sequence, so that $\tr u_n \rightarrow \tr u$ a.e., and by the fact that $\Gamma_m$ has positive Hausdorff measure, we conclude $\tr u = 0$ on $\Gamma_m$.

We define $A:= H^1 \rightarrow H^{1*}$ by $(Au)v:=\int_u\nabla u \nabla v$. This operator can be the recast to $V\rightarrow H^{-1}$ and $V\rightarrow V^*$.

The problem under consideration is the following. For $U = D\setminus \Omega$ we have:

\begin{pb}[Inhomogeneous heat equation, Dirichlet conditions]
\label{pb:diri}
\begin{align}
u_t - \Delta u = 0 \text{ in } (0,T)\times U\\
u(\Sigma_f)=f\\
u(\Sigma_m)=0\\
u(0)=0
\end{align}

By this we mean:

\begin{align}
u \in W(I,H^1_c) \\
u_t|_{H^{-1}} + A u = 0 \text{ in }H^{-1} \text{ and for a.e. } t \in (0,T) \\
\tr u = f \text{ on } \Sigma_f\\
u(0)=0
\end{align}

\end{pb}

\begin{thm}[Well posedness and regularity for \cref{pb:diri}]
Given \cref{ass:diri}, the solution $u$ to \cref{pb:diri} is unique with $u_t \in L^2(I,H)$. 

%The uniqueness holds in more generally in $L^2(I,V)\cap H^1(I, H^{-1})$.

The problem is equivalent to:

\begin{pb}[Equivalent formulation with extension]
\label{pb:diri_ext}
\begin{align}
u_0 \in W(I,H^1_0) \\
u_0' + A u_0 = -((\bar{u}',\cdot)_H+A \bar{u}) \text{ in }H^{-1} \text{ and for a.e. } t \in (0,T) \\
u_0(0)=0
\end{align}
\end{pb}

with $\bar{u}$ any given $\bar{u}\in H^1(I,H^1_c(U))$ such that $\tr \bar{u} =f$ on $\Sigma_f$, and with $\bar{u}(0)=0$. This means that $u$ solves \cref{pb:diri} $\implies$ $u-\bar{u}$ solves \cref{pb:diri_ext}, and if $u_0(\bar{u})$ solves  \cref{pb:diri_ext}, then $\bar{u}+u_0(\bar{u})$ solves \cref{pb:diri}.

Furthermore: 

\begin{align}
\norm{u}^2_{C([0;T],H)}+\norm{u}_{L^2(I,H)}^2+ \norm{\nabla u}_{L^2(I,H)}^2 + \norm{u'}^2_{L^2(I,H)}\leq C(T)\norm{\bar{u}}_{H^1(I,V)}^2
\end{align}

with $C>1$, only dependent on $T$, smoothly, exploding for large $T$.

\end{thm}
\begin{mproof}

\underline{Extension of the boundary data}

Let $\bar{u}\in H^1(I,H^1_c(U))$ be such that $\tr \bar{u} =f$ on $\Sigma_f$, and with $\bar{u}(0)=0$. We can choose for instance $E\tilde{f}$, see \cref{prop:trace}, where $\tilde{f}=0$ on $\Sigma_m$, $\tilde{f}=f$ on $\Sigma_f$. $\tilde{f} \in H^1(I,H^{1/2}(\partial U))$, because $\Gamma_f$ and $\Gamma_m$ have positive distance (see the definition of the norm in \cite{grisvard}, page 20).  

\underline{Reformulation (first part)}

Consider the following commutative diagram, where $V = H^1_c$, $W=H^1_0$:

\[\begin{tikzcd}
	{H^1_c} &&& {(H^1_c)^*} \\
	& H & {H^*} \\
	{H^1_0} &&& {H^{-1}}
	\arrow["c", hook, from=3-1, to=1-1]
	\arrow["a", hook, from=1-1, to=2-2]
	\arrow["b"', hook, from=3-1, to=2-2]
	\arrow["{a^*}", hook, from=2-3, to=1-4]
	\arrow["r", from=2-2, to=2-3]
	\arrow["{b^*}"', hook, from=2-3, to=3-4]
	\arrow["{c^*}", hook, from=1-4, to=3-4]
\end{tikzcd}\]

Here, $a,b,c$ are the trivial injections, $r$ the Riesz isomorphism $h\mapsto(h,\cdot)_H$. 

Now $(i_W (u-\bar{u}) )'+A(u - \bar{u}) = (i_Vu)'|_{H^{-1}}-(i_V\bar{u})'|_{H^{-1}}+Au - A\bar{u} = \ind{\cref{prop:sanity}}  = (i_Vu)'|_{H^{-1}}-(i_V\bar{u}_t)|_{H^{-1}}+Au - A\bar{u} = -(i_V\bar{u}_t)|_{H^{-1}}- A\bar{u}$ if $u$ solves \cref{pb:diri}, where $\bar{u}_t$ is the weak derivative of $\bar{u}$ in the $H^1(I,V)$ sense. Call $u_0 = u-\bar{u}$. By again \cref{prop:sanity}, $u_0 \in W(I,H^1_0)$.

%That $\tr E \tilde{f}=\tilde{f}$ is easily seen for a.a. $t$, and by \cref{lemma:bochner_Hk_map}, we get $\bar{u} \in H^1(I,H^1_c(U))$. The last result could be applied since $H^{1/2}(\partial U)$ is the continuous image of a separable space, hence it is separable, and it is also Banach (again by \cite{grisvard}, page 20).
%
%
%The initial value of $\bar{u}$ is null. To see this, we know that the unique time-continuous representative $U\tilde{f}$ of $\tilde{f}$ (\cite{evans}, page 286, theorem 2, and \cref{prop:cts_repr}) satisfies $\lim_{t\rightarrow 0^+}U\tilde{f}(t)=0$, the limit being in $H^{1/2}(\partial U)$. We also know that $\bar{u}$ has a unique continuous representative $U\bar{u}$ by similar arguments, and $U\bar{u}(t) \rightarrow U\bar{u}(0)$ for $t\rightarrow 0^+$. Now, $ [U\tilde{f}] = \tilde{f} = \tr \bar{u} =[ \tr U\bar{u} ]$, where the square brackets are equivalence classes in time. Thus $U\tilde{f} =  \tr U\bar{u}$ for all $t$, and thus $\tr U\bar{u}\rightarrow 0$ for small times. Applying $E$ we get $U\bar{u}\rightarrow 0$ which is what we wanted to show.

This motivates us to consider the problem: 

\begin{align}
u_0 \in W(I,H^1_0) \\
u_0' + A u_0 = -(f_1+f_2) \text{ in }H^{-1} \text{ and for a.e. } t \in (0,T) \\
u_0(0)=0
\end{align}

Here, $f_1:=(i_V\bar{u}_t)|_{H^{-1}}=c^*a^*ra\bar{u}_t = b^*r (a\bar{u}_t) \in L^2(I,H)$.

Moreover, $A \in L(V, H^{-1})$, so, by \cref{lemma:bochner_Hk_map}, $f_2:=A\bar{u} \in H^1(I, H^{-1})$.

\underline{Existence}

By \cref{thm:par_reg} we get a solution of the above problem with $u_0' \in L^2(I, H)$.

And now, let $u:=\bar{u}+c u_0 =\bar{u}+ u_0 $. We claim it is a solution. The initial and boundary conditions are surely satisfied. We check it is in $W(I,V)$ and is satisfies the partial differential equation.

By \cref{prop:sanity}, we have both $\bar{u}, c u_0 \in W(I,V)$. The derivative of $\bar{u}$ becomes $i_V \bar{u}_t$, see \cref{prop:sanity}. Therefore $(i_V(\bar{u}+c u_0))'|_{H^1_0} = c^* (i_V(\bar{u}+c u_0))' = c^*i_V \bar{u}_t + c^*i_V(c u_0)' = b^*r (a\bar{u}_t) + i_W(u_0)'$ by \cref{prop:sanity}.

Using the pde of $u_0$, $... = b^*r (a\bar{u}_t) - Au_0 -f_1 -f_2 = -A(u_0+\bar{u})$.

\underline{Uniqueness}

For two solutions $u_1, u_2$ of $\ref{pb:diri}$ we can form $d:=u_1-u_2\in W(I,H^1_0)$ by \cref{prop:sanity}. Clearly, $d(0)=0$. Moreover, $(i_{H^1_0} d)' = \ind{\cref{prop:sanity}}=(i_V u_1)'|_{H^1_0}-(i_V u_2)'|_{H^1_0} = A(u_1-u_2)$.

By uniqueness stated in \cref{thm:well_pos_parabolic} we obtain $d=0$ in $L^2(I,H)$, so that the solution is unique and doesn't depend on the choice of the extension of the Dirichlet datum.

\underline{Reformulation (part 2)}

Therefore $u=\bar{u}+u_0$ above is the unique solution of \cref{pb:diri}. So, given any $\bar{u}\in H^1(I,H^1_c(U))$ such that $\tr \bar{u} =f$ on $\Sigma_f$, and with $\bar{u}(0)=0$, we can construct $u_0$ as above and get $u=\bar{u}+u_0$ solving \cref{pb:diri}.

Viceversa, let $u$ solve \cref{pb:diri}. Call $u_0 = u- \bar{u}$. Then, as seen above, $u_0 \in W(I,H^1_0)$ and $(i_V (u-\bar{u}) )'|_{H^{-1}}+A(u - \bar{u}) = (i_Vu)'|_{H^{-1}}-(i_V\bar{u})'|_{H^{-1}}+Au - A\bar{u} = \ind{\cref{prop:sanity}}  = (i_Vu)'|_{H^{-1}}-(i_V\bar{u}_t)|_{H^{-1}}+Au - A\bar{u} = -(i_V\bar{u}_t)|_{H^{-1}}- A\bar{u}$ if $u$ solves \cref{pb:diri}, where $\bar{u}_t$ is the weak derivative of $\bar{u}$ in the $H^1(I,V)$ sense. Call $u_0 = u-\bar{u}$. By again \cref{prop:sanity}, $(i_W (u-\bar{u}) )'+A(u - \bar{u}) = (i_Vu)'|_{H^{-1}}-(i_V\bar{u})'|_{H^{-1}}+Au - A\bar{u} = (i_Vu)'|_{H^{-1}}-(i_V\bar{u}_t)|_{H^{-1}}+Au - A\bar{u} = -(i_V\bar{u}_t)|_{H^{-1}}- A\bar{u} = -b^*r(a\bar{u}_t)-A\bar{u}$. Moreover, $u_0(0)=0$, so that $u_0$ solves \cref{pb:diri_ext}.

%\begin{itemize}
%\item $u_0 \in L^2(I,H^1_0)$
%\item $u_0' \in L^2(I,V^*)+L^2(I,H)\subseteq L^2(I,H^{-1})$
%\item $u_0(0)=0$ in $H$
%\item $u_0$ solves $u_0' + A u_0 = -((\bar{u}',\cdot)_H+\langle A \bar{u},\cdot\rangle_{H^{-1},H^1_0})$
%\end{itemize}

\underline{Regularity}

Let $u=\bar{u}+u_0$ be the unique solution, as before, of \cref{pb:diri}. From \cref{prop:sanity} we know $(i_V(\bar{u}))'=i_V(\bar{u}_t)=a^*r(a\bar{u}_t)$, and $i_V(cu_0)'=a^*r (u_0')$, for $u_0' \in L^2(I,H)$ the representative of $(i_W(u_0))'$, equivalently, the weak derivative of $u_0$ in the $H^1(I,H)$ sense. It follows that $(i_Vu)' = a^*r(a\bar{u}_t+u_0')$, proving the additional time smoothness claim.

\underline{Stability}

Let $\bar{u}\in H^1(I,H^1_c(U))$ such that $\tr \bar{u} =f$ on $\Sigma_f$, and with $\bar{u}(0)=0$. Consider $u_0$. Then, by \ref{thm:const_track}:


\begin{align*}
\norm{u_0}^2_{C([0;T],H)}+\alpha\norm{u_0}_{L^2(I,H^1_0)}^2\leq \exp(2\lambda T)\alpha^{-1}\norm{(\bar{u}',\cdot)_H+ A \bar{u}}^2_{L^2(I,H^{-1})}
\end{align*}

\begin{align*}
C\norm{u_0'}^2_{L^2(I,H)}\leq 
(1+(1+C_0)\alpha^{-1})\norm{A \bar{u}}^2_{H^1(I, H^{-1})}+\\
\norm{(\bar{u}',\cdot)_H}_{L^2(I,H)}^2+C_0\alpha^{-1}\norm{(\bar{u}',\cdot)_H}^2_{L^2(I,H^{-1})}
\end{align*}

$C_0 = \ds 2^{-1}\max(1,\lambda)\max(1,\alpha^{-1})\exp(2\lambda T)$.

We norm $H^1_0$ with the full $H^1$ norm too. Then:
\begin{align*}
\norm{(\bar{u}',\cdot)_H+ A \bar{u}}_{L^2(I,H^{-1})}\leq \\
\sup_{\norm{v}_{L^2(I,H^{1}_0)}=1}\norm{\bar{u}'}_{L^2(I,H)}\norm{v}_{L^2(I,H)}+\norm{\nabla \bar{u}}_{L^2(I,H)}\norm{\nabla v}_{L^2(I,H)}\leq \\C(\norm{\bar{u}'}_{L^2(I,H)}+\norm{\nabla \bar{u}}_{L^2(I,H)})
\end{align*}

By \cref{lemma:bochner_Hk_map}, $\norm{A \bar{u}}_{H^1(I, H^{-1})}\leq \norm{A}_{L(V,H^{-1})}\norm{\bar{u}}_{H^1(I,V)}$ (we could apply it since $H^{-1}$ is separable, as a dual of a reflexive Banach space).

Finally, $\norm{(\bar{u}',\cdot)_H}^2_{L^2(I,H^{-1})}\leq \norm{\bar{u}'}_{L^2(I,H)}^2$.

We can then say:

\begin{align*}
\norm{u_0}^2_{C([0;T],H)}+C\alpha\norm{u_0}_{L^2(I,H^1_0)}^2\leq \exp(2\lambda T)\alpha^{-1}\norm{\bar{u}}^2_{H^1(I,V)}\\
C\norm{u_0'}^2_{L^2(I,H)}\leq 
((1+(1+C_0)\alpha^{-1})\norm{A}_{L(V,H^{-1})}^2 +1 +C_0\alpha^{-1})\norm{\bar{u}}^2_{H^1(I,V)}
\end{align*}

Now, $\langle Av, v\rangle_{H^{-1}, H^1_0} + 1\cdot  \HN{v}^2 = 1\cdot \norm{v}_{H^1_0}^2$, so that $\alpha=\lambda=1$. Moreover, $\langle Au, v\rangle_{H^{-1}, H^1_0}\leq \VN{u}\norm{v}_{H^1_0}$, i.e. $\norm{A}_{L(V,H^{-1})}\leq 1$.

Therefore $\norm{u_0}^2_{C([0;T],H)}+\norm{u_0}_{L^2(I,H^1_0)}^2 + \norm{u_0'}^2_{L^2(I,H)}\leq C(T)\norm{\bar{u}}_{H^1(I,V)}^2$ with $C>1$, only dependent on $T$, smoothly, exploding for large $T$.

Now, let's analyse the norms of $\bar{u}$. Because $\bar{u}\in H^1(I,V)$, then, $\bar{u} \in C([0,T],V)\emb C([0,T],H)$, where the embedding is non-expansive by the choice of the norm of $V$. Therefore $\norm{\bar{u}}_{C([0;T],H)}\leq \norm{\bar{u}}_{C([0;T],V)}\leq (1+T)\norm{\bar{u}}_{H^1(I,V)}$. We can therefore conclude that $\norm{u}^2_{C([0;T],H)}+\norm{u}_{L^2(I,H^1_0)}^2 + \norm{u'}^2_{L^2(I,H)}\leq C(T)\norm{\bar{u}}_{H^1(I,V)}^2$ with $C>1$, only dependent on $T$, smoothly, exploding for large $T$.



\end{mproof}

\subsection{Inhomogeneous Neumann-Dirichlet problem}

We make the following assumption.

\begin{ass}[Assumptions for \cref{pb:diri}]
\label{ass:neu}
We keep \cref{ass:diri} (apart from the Dirichlet datum). We consired $g \in H^1(I, L^2(\Gamma_f))$, $g(0)=0$.
\end{ass}

Again, call $H=L^2(U)$, $V=\{ v \in H^1(U), \tr u = 0 \text{ on } \Gamma_m\}=:H^1_c$. $H,V$ induce a Gelfand triple as seen before. 


The problem under consideration is:

\begin{pb}[Inhomogeneous heat equation, Neumann conditions]
\label{pb:neu}
\begin{align}
u_t - \Delta u = 0 \text{ in } (0,T)\times U\\
\partial_\nu u(\Sigma_f)=g\\
u(\Sigma_m)=0\\
u(0)=0
\end{align}

By this we mean:

\begin{align}
u \in W(I,H^1_c) \\
u_t + A u = G \text{ in } V^* \text{ and for a.e. } t \in (0,T) \\
u(0)=0
\end{align}

where $\langle G(t), v \rangle_{V^*,V}:=\int_{\Gamma_f} g(t)\tr v d\sigma$, $\sigma$ the $1$-codimensional Hausdorff measure, and $A$ was introduced before in $L(V,H^{-1})$.

\end{pb}

By \cref{lemma:bochner_Hk_map}, $G \in H^1(I,V^*)$. In fact, define $T: L^2(\Sigma_f)\rightarrow V^*$ by $\langle Tg,v \rangle_{V^*,V}:=\int_{\Gamma_f} g\tr v d\sigma$. Then, $\langle Tg,v \rangle_{V^*,V} \leq \norm{g}_{L^2(\Gamma_f)} \VN{v}$ by trace theory. Now, $G(t)=Tg(t)$.

Moreover, $\langle A v, v \rangle_{V^*,V}+ 1 \cdot \HN{v} = 1\cdot \norm{V}$, so that we can immediately conclude:

\begin{thm}[Well posedness and regularity for \cref{pb:neu}]
Given \cref{ass:neu}, the solution $u$ to \cref{pb:neu} is unique with $u_t \in L^2(I,H)$.

Furthermore: 

\begin{align}
\norm{u}^2_{C([0;T],H)}+\norm{u}_{L^2(I,H)}^2+ \norm{\nabla u}_{L^2(I,H)}^2 + \norm{u'}^2_{L^2(I,H)}\leq C(T)\norm{g}_{H^1(I,L^2(\Gamma_f))}^2
\end{align}

with $C>1$, only dependent on $T$, smoothly, exploding for large $T$.
\end{thm}
\begin{mproof}

It is an application of \cref{thm:well_pos_parabolic}, \cref{thm:reg_time} and \cref{thm:const_track}.
\end{mproof}

\section{Reformulation of parabolic equations}

We just saw that the two parabolic equations of interest can be recasted into the problem of finding $u\in W(I,V)$, $u(0)=0$, $u_t+Au=f$ for a.e. $t$ in $V^*$, with notation from preceding sections.

In particular, $f \in L^2(I, V^*)$ and so is $Au$ (because $A\in L(V,V^*)$, and by \ref{lemma:bochner_Hk_map}).

Call then $E(u):=u_t+Au-f \in L^2(I,V^*)$ and $W_0(I,V)$ the $W(I,V)$ functions with zero initial value. Then, the differential equation reads $\langle E(u)(t),v\rangle_{V^*,V}=0$ for all $v\in V$, for a.a. $t$, equivalently, $E(u)=0$ for a.a. $t$. Thus, we are interested in the abstract problem:

\begin{pb}[Even more abstract parabolic equation]
\label{pb:more_abstr_par}
Given a function $E: W(I,V)\rightarrow L^2(I,V^*)$, find $u\in W_0(I,V)$, such that $E(u)=0$ for a.a. $t$.
\end{pb}
 
We can view $L^2(I,V^*)\cong L^2(I,V)^*$.

Hence $\langle E(u), v\rangle_{L^2(I,V)^*, L^2(I,V)}=\int_I \langle E(u)(t),v(t) \rangle_{V^*,V} dt$ (see \cite{hinze}, theorem 1.31 at page 39).

Now, by \ref{prop:weak_class}, we get $C_c^\infty(I,V) \subseteq H^1(I,V) \subseteq W(I,V)$. Actually, $C_c^\infty(I,V) \subseteq  W^0(I,V)$, the functions of $W(I,V)$ having zero terminal values.

We have therefore $C_c^\infty(I,V) \subseteq  W^0(I,V) \subseteq L^2(I,V)$, which implies that $  W^0(I,V)\subseteq L^2(I,V)$ is dense in $L^2(I,V)$. We can then formulate:

\begin{prop}[Equivalent testing]
Let $E: W(I,V)\rightarrow L^2(I,V^*)$, and $u\in W_0(I,V)$.

Then:

\begin{align*}
E(u)=0 \\
\iff \\
\langle E(u), v\rangle_{L^2(I,V)^*, L^2(I,V)}=0 \quad \forall v \in L^2(I,V)\\
\iff \\
\langle E(u), v\rangle_{L^2(I,V)^*, L^2(I,V)}=0 \quad \forall v \in W^0(I,V)
\end{align*}

\end{prop}

\chapter{Facts about domains transformations}

Throughout, $D$ is a bounded Lipschitz domain. We define as in \cite{murat} the following spaces of transformations:

\begin{defn}[Spaces of transformations]
We define:
\begin{itemize}	
	\item $\pazocal M:=\{\tau: \mR^n \rightarrow \mR^n \text{ measurable } \}/\sim$, the quotient being the almost everywhere equal relation
	\item $\cV^k=\{\tau \in \pazocal{M}, \tau-\id \in W^{k,\infty}(\mR^n,\mR^n)\}$, $k\geq 1$
	\item $U: \cV^k\rightarrow \text C^{0,1}(\mR^n;\mR^n)$, and $U:W^{1,\infty}(\mR^n,\mR^n) \rightarrow \text C^{0,1}(\mR^n;\mR^n)$ the application "unique Lipschitz continuous representative" (see \cref{prop:lip})
	\item $\circ: \cV^1 \times \cV^1 \rightarrow \cV^1$ and $\circ:W^{1,\infty}(\mR^n,\mR^n) \times \cV^1 \rightarrow W^{1,\infty}(\mR^n,\mR^n)$ by $\tau_1\circ\tau_2 = [U(\tau_1)\circ \tau]$, for any $[\tau]=\tau_2$, $[]$ being an equivalence class according to $\sim$.
	\item $\cT^k=\{\tau \in \cV^k \text{ with an } \eta \in \cV^k, \tau \circ \eta = \eta \circ \tau = \id\}$. Any such $\eta$ is unique, we denote it by $\tau^{-1}$ and we have that $U(\tau)$ is a Lipschitz homeomorphism with $U(\tau^{-1})=U(\tau)^{-1}$
\end{itemize} 
\end{defn}

\begin{obs}[A technicality]

Technically, in the original definition of \cite{murat}, $\tau$ need not to be a continuous function, although this is suggested e.g. in remarque 2.1 at page II-4. 

Going to equivalence classes of $\tau$ makes the identification with continuous functions more precise, as we now show.

\underline{One implication}

Let $\tau: \mR^n\rightarrow\mR^n$ with $[\tau-\id] \in W^{k,\infty}$. Then $\tau$ is equal a.e. to a (Lebesgue) measurable function, hence also (Lebesgue) measurable, and thus $[\tau] \in \cV^k$ as we have defined it.

Now, suppose $\tau$ is a bijection, and $[\tau^{-1}-\id] \in W^{k,\infty}$ too. Then $\tau = \id + g = G, \tau^{-1} = \id + h = H$ almost everywhere. Here, $G,H$ are at least Lipschitz.
But then $\tau \circ H = \id $ a.e., and since $H$ is Lipschitz, we can conclude also $G\circ H = \id$ a.e., so, everywhere. With a symmetric reasoning, we are lead to $G=H^{-1}$, so that $G$ is bi-Lipschitz.

Thus, $[\tau]\circ [\tau^{-1}]:=[U(\tau)\circ U(\tau^{-1})] = [G\circ G^{-1}] = \id$ and an analogous reasoning leads to $[\tau] \in \cT^k$ as we have defined it.

\underline{The other implication}

It is immediate for $\cV^k$ and for $\cT^k$, in the equivalence class of $\tau \in \cT^k$ there is a unique $U(\tau)$ at least bi-Lipschitz, hence invertible, with $[U(\tau)]=\tau$.

This shows that:

\begin{enumerate}
\item $\{\tau: \mR^n\rightarrow\mR^n$ with $[\tau-\id] \in W^{k,\infty}\} / \sim = \cV^k$
\item $\{\tau: \mR^n\rightarrow\mR^n$ bijection with $[\tau^{\pm 1}-\id] \in W^{k,\infty}\}/\sim = \cT^k$
\end{enumerate}

\end{obs}

We need to check the well-posedness of $\circ$.

\begin{prop}
$\circ: \cV^1 \times \cV^1 \rightarrow \cV^1$ and $\circ:W^{1,\infty}(\mR^n,\mR^n) \times \cV^1 \rightarrow W^{1,\infty}(\mR^n,\mR^n)$ are well defined.
\end{prop}
\begin{mproof}

We start by $\circ:W^{1,\infty}(\mR^n,\mR^n) \times \cV^1 \rightarrow \cV^1$. Aside from its measurability, which follows by the continuity of $U(\te)$, we have $\te\circ \tau =[ U(\te)\circ U(\tau)]$ for instance, the latter being is a bounded Lipschitz map, so it remains in $W^{1,\infty}$. For the second claim, just write $\eta \circ \tau -\id = (\eta - \id)\circ \tau + \tau -\id$ and use the first part. 

\end{mproof}

\begin{prop}
\label{prop:circ_wd}
$\circ: \pazocal{M} \times \cT^1 \rightarrow \pazocal{M}$ given by $[f]\circ[U(\psi)] = [f\circ U(\psi)]$ is well defined.

It is also well defined from $\{ [f], f : \mR^n\rightarrow \mathbb{R}^k \text{ continuous }\}\times \pazocal{M}$ into measurable functions, by $f\circ[\phi]:=[U(f)\circ \phi]$.
\end{prop}
\begin{mproof}

Suppose $f,g \in [f]$. Then $f=g$ everywhere but on the null set $E$. Because $\psi \in \cT^1$ we know that $U(\psi)$ is a Lipschitz homeomorphism, so that $U(\psi)^{-1}(E)$ has zero measure by the lemma of Vitali. For the same reason, the composition is measurable, see \cite{murat}, remarque 2.2, page II-7.

\end{mproof}

\begin{prop}[Chain rule for $k=1$]
\label{prop:chain}
Let $f \in W^{1,\infty}(\mR^n,\mR^n)$ or $\cV^1$, together with $\psi \in \cT^1$.  Then:

\begin{itemize}

\item $f \circ \psi$ has essentially bounded weak derivatives, and $D(f \circ \psi) = Df \circ \psi D\psi$. The equality holds a.e. also for the classical derivatives.

\item  $(D(\psi^{-1}))^{-1} = D\psi \circ \psi^{-1}$, where $(D(\psi^{-1}))^{-1}:=[(DU(\psi^{-1}))^{-1}]$, the representative being a.e. invertible. The equality holds a.e. also for the classical derivatives.

\item $|\det(D\psi)|$ is an essentially bounded measurable function with $|\det(D\psi)|\geq \delta>0$ a.e.. 
\end{itemize} 

\end{prop}
\begin{mproof}

\underline{Weak derivatives}

We notice that $f \circ \phi$ has a unique Lipschitz representative, that is $U(f)\circ U(\phi)$. The desired formula follows as in \cite{murat}, lemme 2.1 at page II-6, for the classical derivatives (or from \cite{ziemer}, page 53, theorem 2.2.2 in the case of left composition by $ W^{1,\infty}(\mR^n,\mR^n)$ vector fields).

For the weak derivatives:

\begin{itemize}
	\item $U(f)$ is Lipschitz, so that $DU(f)$, the classical derivative, is also the weak derivative $Df$ (note that $f$ need not to be essentially bounded to state this). The latter is a measurable function, as a.e. limit of difference quotients.
	\item $DU(f)\circ U(\psi)$,  as pointed out in \cite{murat}, remarque 2.2, page II-7, is measurable. It is also essentially bounded.
	\item By \cref{prop:circ_wd} we observe that $DU(f)\circ U(\psi)$ represents $Df \circ \psi$
	\item $D\psi = [DU(\psi)]$ as seen above
	\item the product of equivalence classes is always defined as the product of their representatives
\end{itemize}

Therefore $ Df \circ \psi D\psi = [DU(f)\circ U(\psi) DU(\psi)]$.

And now, because $f \circ \phi$ is Lipschitz, it has weak derivatives, $D(f \circ \phi)$, equal to the classical derivatives $DU(f\circ \phi) = D (U(f)\circ U(\psi)) = DU(f)\circ U(\psi) DU(\psi)$, where the last equality holds a.e., as mentioned at the beginning of the proof.

This let us conclude the first claim.

\underline{Inverse Jacobian}

For the second one, put $f = \psi^{-1}$. Then, for the classical derivatives, $I = DU(\psi)\circ U(\psi)^{-1} DU(\psi^{-1})$ a.e., so that both $DU(\psi)\circ U(\psi)^{-1}, DU((\psi)^{-1})$ are invertible as matrices, a.e.. 

\underline{Determinant}

We have defined $|\det(D\psi)|:=[|\det DU(\psi)|]$, see \cref{prop:circ_wd}. The claim follows as in lemme 4.2, pag. IV-7 of \cite{murat}, and because $\det$ is a polynomial of essentially bounded functions.

\end{mproof}

We go on to define the space of admissible transformations.

\begin{defn}[Admissible transformations]
We define $\Theta:=\{\theta \in W^{1,\infty}(\mR^n,\mR^n) \text{ with } \theta|_D\in W^{2,\infty}(D;\mR^n) \text{ and } \theta=0 \text{ on } \mR^n \setminus D\}$, a vector space.


We also define $\cT:=\{\tau \in \cT^1, \tau^{\pm 1}|_{\mR^n\setminus D}=\id, \tau^{\pm 1}|_D \in W^{2,\infty}(D; \mR^n)\}$. 

\end{defn}

\begin{prop}[Some group properties of $\cT$]
\label{prop:group}
Let $\eta, \tau \in \cT, \te \in \Te$. Then:

\begin{itemize}
	\item $\eta \circ \tau \in \cT$
	\item $\te \circ \tau \in \Te$
	\item $\id$ is the neutral element
	\item $\eta^{-1} \in \cT$
\end{itemize}

\end{prop}
\begin{mproof}

\underline{Stability under composition (regularity)}

We start by showing that $\tau \circ \eta |_D \in W^{k,2}$.

By $\tau \in \cV^1$, we sure have that $\tau \circ \eta \in \cV^1$ by \cref{prop:circ_wd}. So, $U(\tau)\circ U(\eta) = \id + \te$, a bounded Lipschitz function, which is $W^{1,\infty}(D)$. Morevoer $ D(U(\tau)\circ U(\eta)) = D(U(\tau))\circ U(\eta) DU(\eta) $ almost everywhere in $D$. Actually, $\eta$ happens to be in $W^{2,\infty}(D)$, so that $U(\eta) \in C^{1,1}(D)$, see \cref{prop:lip}., and the equality holds everywhere.

This is a product of a bounded Lipschitz function and a bounded Lipschitz function, so it is also bounded Lipschitz. Therefore, $D(U(\tau)\circ U(\eta))\in C^{0,1}(D)$ and thus $U(\tau)\circ U(\eta) \in C^{1,1}_B(D)$, so that by $\ref{prop:lipk}$, $[U(\tau)\circ U(\eta)|_D] = \tau \circ \eta|_D \in W^{2,\infty(D)}$.

This same proof shows that for $\te \in \Te$, $\tau \in \cT$, $\te \circ \tau \in \Te$, because $\te \circ \tau$ was already a $W^{1,\infty}$ function by \cref{prop:circ_wd}, and because $\tau$ fixed $\mR^n \setminus D$.

\underline{Stability under inversion}

It is trivial, because the definition of $\cT$ is symmetric with respect to inversion.

\underline{Stability unded composition ($\cT^1$)}

$\eta \circ \tau$ is surely in $\cV^1$ by \cref{prop:circ_wd}. Now, by the above point, $\tau^{-1} \circ \tau^{-1}$ is in $\cV^1$ too, and the composition yields: $(\eta \circ \tau)\circ (\tau^{-1} \circ \tau^{-1}) = [U(\eta)\circ U(\tau)]\circ [(U\tau)^{-1} \circ (U\tau)^{-1}] = \id$.

\end{mproof}

\begin{prop}[Gateaux differentiability]
Consider $J:\cT \rightarrow E$ for $E$ some Banach space.

Let $\tau \in \cT$. Then:

$$ \forall \delta\te \in \Te \text{ exists } \lim_{t\rightarrow 0}\frac{J(\tau + t \delta\te)-J(\tau)}{t} \iff  \forall \delta\te \in \Te  \text{ exists }\lim_{t\rightarrow 0}\frac{J((\id +t \delta \te)\circ \tau)-J(\tau)}{t}$$

In case of existence, we have:

$$ \lim_{t\rightarrow 0}\frac{J((\id +t \delta \te)\circ \tau)-J(\tau)}{t} = \lim_{t\rightarrow 0}\frac{J(\tau + t \delta \te\circ \tau)-J(\tau)}{t}$$

\end{prop}

\begin{mproof}

It suffices to show that $\Te \circ \tau = \Te$.

In fact, $\delta \te \circ \tau \in \Te$ for $\te \in \Te$, as we verified in \cref{prop:group}. Using the same result, $\tau^{-1} \in \cT$, $(\delta \te \circ \tau ) \circ \tau^{-1}  \in \Te$ and $(\delta \te \circ \tau ) \circ \tau^{-1} = [U(\delta \te)\circ U(\tau)]\circ[U(\tau)^{-1}] = [(U(\delta \te)\circ U(\tau))\circ(U(\tau)^{-1})]=\delta \te$.

\end{mproof}

\begin{thm}[Change of variables]

Let $U$ be open and $T = U(\tau)$ for $\tau \in \cT^1$, and let $p \in [ 1,\infty]$. Then:

\begin{enumerate}
	\item $f \in L^p(T(U)) \iff f\circ T \in L^p(U)$ and there holds, for $f \in L^p(T(U))$:
	$$ \norm{f}_{L^p(T(Q))}\leq \left ( \norm{\det DT}_{L^\infty(\mR^n)}\right)^{1/p} \norm{f\circ T}_{L^p(Q)}$$
	\item $f \in W^{1,p}(T(U)) \iff f\circ T \in W^{1,p}(U)$ and there holds, for $f\in W^{1,p}(T(U))$:
	$$Df \circ T = (Df)^{-t}D(f\circ T)$$
	$$ \norm{Df}_{L^p(T(Q);\mR^n)}\leq \left ( \norm{\det DT}_{L^\infty(\mR^n)}\right)^{1/p} \norm{(DT)^{-1}}_{L^\infty(\mR^n;\mR^{n\times n})}\norm{D(f\circ T)}_{L^p(Q;\mR^n)}$$
	\item if $p \in (1, \infty)$, $f \in W^{1,p}_0(T(U)) \iff f\circ T \in W^{1,p}_0(U)$
	\item therefore, composition by $T$ is a linear isomorphism between $W^{k,p}(T(U))\rightarrow W^{k,p}(U)$ for $k=0,1$, and between $W^{1,p}_0(T(U))\rightarrow W^{1,p}_0(U)$ for $k=0,1$, $p \in (1, \infty)$
	\item for $D$ a bounded Lipschitz domain and $\cT, \Te$ defined before, we get, for $f \in H^1(D)$, that $\tr f = \tr(f\circ T)$
	\item if moreover, $\Omega, T(\Omega) \cc D$ are also bounded Lipschitz domains, letting $U:=D\setminus \Omega$, for $f \in H^1(T(U))$ and $\tr_{T(U)} f =0 $ on $ \partial T(\Omega) $, then $\tr_{U} f\circ T=0$ on $\partial \Omega$ and $\tr_{T(U)} f = \tr_{U} f\circ T$ on $\partial D$
\end{enumerate}

\end{thm}

\begin{mproof}

We need to prove only the last points, for the other are proved in \cite{murat}, pages IV.4, IV.5, IV.6.

\underline{Static strace}

To do so, let $f_n \in C(\overline{D})\cap H^1(D)$ converging in $H^1(D)$ to $f$. By point 4, we have $f_n \circ T\rightarrow f\circ T$ in $H^1(D)$ (rememeber, $T(D)=D$ by invertibility of $T$ and the fact that $T(x)=x$ outside of $D$). Therefore we have:

$$\tr f \leftarrow_{L^2(\partial D)}\tr(f_n) = f_n|_{\partial D} = (f_n\circ T)|_{\partial D}= \tr(f_n \circ T)\rightarrow_{L^2(\partial D)} \tr(f \circ T)$$

\underline{Zero moving trace}

First of all, as $T$ is a homeomorphism of $\mR^{n}$, $TU=D\setminus T(\Omega)$, $T\partial U = \partial D \sqcup \partial \Omega$, $T\partial \Omega = \partial T \Omega$.

Now, an application of \cref{thm:ibp} yields that the extension to $0$ in $T\Omega$ of $f$, call it $\bar{f}$, is $H^1(D)$, with $\partial_i \bar{f}=\partial_i f$ in $TU$, $0$ in $T(\Omega)$.

We claim that $\tr_D \bar{f} = \tr_{T(U)} f|_{\partial D}$. In fact, approximate $\bar{f}$ by restrictions to $D$ of $C^\infty_c(\mR^n)$ functions $f_n$, which also approximate $f$ on ${T(U)}$, by the observation that $\norm{f_n|_{T(U)}}_{H^1({T(U)})}\leq \norm{f_n|_D}_{H^1(D)}$. Then:

$$\tr_{T(U)}( f_n|_{T(U)})|_{\partial D} = (f_n|_{T(U)})|_{\partial {T(U)}}|_{\partial D} = f_n|_{\partial D} = \tr_D ( f_n|_D ) $$

Now, by what we observed before, $\tr_{T(U)}( f_n|_{T(U)})\rightarrow \tr_{T(U)}(f) $ in $L^2(\partial {T(U)})$, so that $\tr_{T(U)}( f_n|_{T(U)})|_{\partial D} \rightarrow \tr_{T(U)}( f)|_{\partial D}$. On the other hand $\tr_D ( f_n|_D ) \rightarrow \tr_D \bar{f}$, which yields the claim.

Using this: $ \tr_{T(U)}( f)|_{\partial D} = \tr_D \bar{f} = \ind{point 5} = \tr_D(\bar{f}\circ T) = \tr_D(\overline{f \circ T}) = \tr_U (f\circ T)|_{\partial D}$, where we used that $\bar{f}\circ T$ is zero in $T^{-1}T\Omega = \Omega$ (because again $T$ maps null sets into null sets), so it is the zero extension $\overline{f \circ T}$ of $f\circ T$. Both $\bar{f}\circ T$ and $f\circ T$ are $H^1$ functions by point 2.

We can now also say that $\tr_U f\circ T=0 $ on $\partial \Omega$.

%In fact, let $\phi \in C^\infty_c(D)$. Then $ \int_D \bar{f}\circ T \phi_{,i} = \int_U  f\circ T \phi_{,i} = \ind{using \cref{thm:ibp}} = \int_{\partial \Omega}\tr_U(f\circ T) \phi \nu_i d\sigma -\int_U \partial_i(f\circ T)\phi =  \int_{\partial \Omega}\tr_U(f\circ T) \phi \nu_i d\sigma -\int_D \partial_i(\bar{f}\circ T)\phi  =  \int_{\partial \Omega}\tr_U(f\circ T) \phi \nu_i d\sigma +\int_D \bar{f}\circ T \phi_{,i}  $.
%
%It follows that $\int_{\partial \Omega}\tr_U(f\circ T) \phi \nu_i d\sigma = 0$ for all $\phi \in C^\infty_c(D)$. Let now $\phi_n \in C^\infty_c(\mR^n)$ approximate $f\circ T$ in $H^1(U)$ as seen above. Choose a cut-off function $\eta$ that is $1$ in a small neighbourhood of $ \Omega$ and $0$ in the complement of $D$ and a small neighbourhood of $\partial_D$. Then $\eta \phi_n$ is in $C^\infty_c(D)$ and:

$$(\eta \phi_n)|_{\partial \Omega} = \tr_U( \phi_n|_U)_{\partial \Omega} \rightarrow \tr_U(f \circ T)_{\partial \Omega}$$
%
%the limit being in $L^2(\partial \Omega)$. Because  $\eta \phi_n$ is in $C^\infty_c(D)$ we can choose it $\phi$ in $\int_{\partial \Omega}\tr_U(f\circ T) \phi \nu_i d\sigma = 0$, yielding:
%
%$$\int_{\partial \Omega}\tr_U(f\circ T) \phi_n \eta \nu_i d\sigma = 0$$ 
%
%This implies, thanks to the boundedness and measurability of $\nu_i$, that:
%
%$$\int_{\partial \Omega}\tr_U(f\circ T)^2\nu_i d\sigma = 0$$

\underline{Multiplication by a $W^{1,\infty}$ function}

We claim that, for $\psi \in W^{1,\infty}(\mR^n;\mR)$ and $f \in H^1(U)$, then $f\psi$ has the same trace as $f$ as long as $\psi = 1$ in a neighbourhood of $\partial U$.

Note that $f\psi \in H^1(U)$ still. Now: approximate $f$ by restriction of test functions $f_n$. Then $f_n \psi$ is $C(\overline{U})\cap H^1(U)$ (thanks also to \cref{prop:lipk}), so that $\tr_U(f_n\psi) = \tr_U(f_n)$. Because $f_n \psi \rightarrow f \psi$ is $H^1(U)$ the claim is valid.

This last convergence follows from $\norm{(f_n-f)\psi}_{L^2}\leq \norm{(f_n-f)}_{L^2}\norm{\psi}_{L^\infty}$, the chain rule $\partial_i(f_n\psi)=\partial_i f_n \psi + \partial_i \psi f_n$ (see \textcolor{red}{corollary 4.1.18 \href{https://www.math.stonybrook.edu/~joa/PUBLICATIONS/SOBOLEV.pdf}{here}}) and again $\norm{\partial_i(f_n-f)\psi}_{L^2}\leq \norm{\partial_i(f_n-f)}_{L^2}\norm{\psi}_{L^\infty}$, $\norm{(f_n-f)\partial_i\psi}_{L^2}\leq \norm{(f_n-f)}_{L^2}\norm{\partial_i\psi}_{L^\infty}$.

\underline{Reducing to a function of $0$ trace}

Let $\eta$ be a smooth cut-off function which is $1$ close to $\partial D$ and $0$ close to $\partial T\Omega$, $\beta=0$ close to $\partial D$ and $1$ close to $\partial T\Omega$. This can be accomplished by e.g. building a suitable partition of unity of the compact sets $\partial \Omega$ and $\partial D$. (\textcolor{red}{can I do this? Yes, see bachelor's thesis, take $K =\partial \Omega$ etc. Also, be careful with all of these equalities...}).

%Then $\beta + \eta = 1$ on $\partial T(U)$ and thus $\tr_{T(U)} f = \tr_{T(U)} (f(\eta+\beta)) = \tr_{T(U)} f\eta+\tr_{T(U)} f\beta$.

$f\beta$ has zero trace, as it can be verified by approximating $f$ by smooth functions again: 

$$\tr_{T(U)} f\beta \leftarrow_{L^2(\partial T(U))} \tr_{T(U)} f_n \beta $$

where the latter quantity is $\tr_{T(U)} f_n $ on $\partial D$ and $0$ on $\partial T(U)$. By restricting the convergence  to first $\partial D$ and then to $\partial T(U)$, and using almost everywhere convergent subsequences, we conclude that $\tr_{T(U)} f \beta = \tr_{T(U)} f $ on $\partial T(U)$ and  $\tr_{T(U)} f \beta = 0 $ on $\partial D$, i.e.  $f\beta$ has zero trace.

%The same argument yields that $\tr_{T(U)} f \eta = \tr_{T(U)} f $ on $\partial D$ and  $\tr_{T(U)} f \eta = 0 $ on $\partial T(U)$.
%
%Hence $\tr_{T(U)} f |_{\partial T(U)}= \tr_{T(U)} f\beta |_{\partial T(U)}$, with $f\beta$ of zero trace on $T(U)$. 

\underline{Domain transformation}

But zero trace functions in $H^1(T(U))$, since $T(U)$ is assumed to be bounded Lipschitz, are exactly the functions $H^1_0(T(U))$ (theorem 18.7 at page 595 of \cite{leoni}).

By then point 4, $(f\beta)\circ T \in H^1_0(U)$.

Because $T$ is bi-Lipschitz, we can write $(f\beta)\circ T = f \circ T \beta \circ T$ almost everywhere.

We have that $\beta \circ T +  \eta \circ T$ is $W^{1,\infty}$ and $1$ near $\partial U$. 

So, $\tr_U f\circ T = tr_U f\circ T(\beta \circ T +  \eta \circ T) = \tr_U (f\circ T\beta \circ T) + \tr_U (f\circ T  \eta \circ T)$.

Approximate $f\circ T$ by $g_n$ smooth as seen above.  Then, $\tr_U (g_n \eta \circ T)$ is $0$ on $\partial U$ and $\tr_U g_n$ on $\partial D$. By selecting an almost everywhere convergent subsequence, we conclude $\tr_U (f\circ T \eta \circ T) = 0$ on $\partial \Omega$. 

Hence  $\tr_U f\circ T|_{\partial \Omega} = tr_U f\circ T(\beta \circ T)|_{\partial \Omega} = 0$.

\end{mproof}

\printbibliography[title={Bibliography}]

\addcontentsline{toc}{chapter}{Bibliography}


\end{document}
